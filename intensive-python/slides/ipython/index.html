<!doctype html><html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Dr. CS codes iPython</title>
<meta name=viewport content="width=device-width">
<link rel=stylesheet href=http://DrCS.codes//css/syntax.css>
<link rel=stylesheet href=http://DrCS.codes//css/main.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=http://DrCS.codes//css/navbar-top-fixed.css rel=stylesheet>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
<a class=navbar-brand href=/intensive-python></a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="navbar-collapse collapse" id=navbarCollapse>
<ul class="navbar-nav mr-auto">
<li class=nav-item><a class=nav-link href=/intensive-python/getting-started/>Getting Started</a></li>
<li class=nav-item><a class=nav-link href=/intensive-python/lessons/>Lessons</a></li>
</ul>
<ul class="navbar-nav pull-right">
<li class="nav-item pull-right"><a class=nav-link href=http://DrCS.codes/>Dr. CS codes</a></li>
</ul>
</div>
</nav>
<main role=main class=container>
<ul>
<li>SciPy</li>
</ul>
<p>** The SciPy Stack</p>
<p>[[https://www.scipy.org/][SciPy]] is a Python-based ecosystem of libraries and tools for scientific computing and data analytics</p>
<ul>
<li>[[http://ipython.org/][iPython]]</li>
<li>[[http://jupyter.org/][Jupyter notebooks]]</li>
<li>[[http://www.numpy.org/][Numpy]]</li>
<li>[[http://pandas.pydata.org/][Pandas]]</li>
<li>[[http://matplotlib.org/][Matplotlib]]</li>
</ul>
<p>iPython is the primary way of interacting with the SciPy stack &ndash; whether through the shell or a Jupyter notebook &ndash; so we&rsquo;ll learn iPython first</p>
<p>** iPython</p>
<p>Two modes:</p>
<ul>
<li>
<p>Interactive shell</p>
<ul>
<li>Replacement for ~python~ REPL</li>
</ul>
</li>
<li>
<p>Jupyter notebook</p>
<ul>
<li>Interactive web-based documents mixing text, executable code, graphics</li>
</ul>
</li>
</ul>
<p>Before we proceed, make sure your computer is ready (OS shell):</p>
<p>#+BEGIN_SRC sh
$ conda update conda
$ conda update python ipython jupyter numpy pandas matplotlib</p>
<p>#+END_SRC</p>
<p>** iPython Shell History</p>
<p>#+BEGIN_SRC sh
In [1]: [&lsquo;Sage&rsquo;, &lsquo;Thyme&rsquo;, &lsquo;Oragano&rsquo;, &lsquo;Posh&rsquo;]
Out[1]: [&lsquo;Sage&rsquo;, &lsquo;Thyme&rsquo;, &lsquo;Oragano&rsquo;, &lsquo;Posh&rsquo;]</p>
<p>In [2]: type(In[1])
Out[2]: str</p>
<p>In [3]: type(Out[1])
Out[3]: list</p>
<p>In [4]: spices = Out[1]</p>
<p>In [5]: spices
Out[5]: [&lsquo;Sage&rsquo;, &lsquo;Thyme&rsquo;, &lsquo;Oragano&rsquo;, &lsquo;Posh&rsquo;]</p>
<p>In [6]: spices is Out[1]
Out[6]: True
#+END_SRC</p>
<p>~In~ is a list, ~Out~ is a dict.</p>
<p>** iPython Help</p>
<p>Single ~?~ gives abbeviated version of python&rsquo;s ~help~</p>
<p>#+BEGIN_SRC sh
In [7]: def add(a, b):
&mldr;: &ldquo;&ldquo;&ldquo;Return the result of + operation on a and b&rdquo;&rdquo;&rdquo;
&mldr;: return a + b
&mldr;:
In [8]: add?
Signature: add(a, b)
Docstring: Return the result of + operation on a and b
File: ~/cs2316/
Type: function
#+END_SRC</p>
<p>Double ~??~ gives source code, if available.</p>
<p>#+BEGIN_SRC sh
In [9]: add??
Signature: add(a, b)
Source:
def add(a, b):
&ldquo;&ldquo;&ldquo;Return the result of + operation on a and b&rdquo;&rdquo;&rdquo;
return a + b
File: ~/cs2316/
Type: function
#+END_SRC</p>
<p>** iPython Magic Commands</p>
<p>Special commands provided by iPython, prepended by ~%~.</p>
<ul>
<li>
<p>Run a Python script from within iPython:
#+BEGIN_SRC sh
In [35]: %run people.py
[&lt;Stan, 2008-08-13, 150cm, 45kg>,
&lt;Kyle, 2008-02-25, 160cm, 50kg>,
&lt;Cartman, 2008-05-26, 140cm, 100kg>,
&lt;Kenny, 2009-07-30, 130cm, 40kg>]
#+END_SRC</p>
</li>
<li>
<p>Get help with a magic command with ~?~
#+BEGIN_SRC sh
In [2]: %cd?
Docstring:
Change the current working directory.</p>
</li>
</ul>
<p>This command automatically maintains an internal list of directories
you visit during your IPython session, in the variable _dh. The
command %dhist shows this history nicely formatted. You can also
do &lsquo;cd -&rsquo; to see directory history conveniently.</p>
<p>Usage:</p>
<p>cd &lsquo;dir&rsquo;: changes to directory &lsquo;dir&rsquo;.
(additional output elided)
#+END_SRC</p>
<p>Get a list of all magic commands with ~%lsmagic~</p>
<p>** iPython Shell Commands</p>
<p>Run shell commands by prepending with a ~!~</p>
<p>#+BEGIN_SRC sh
In [27]: !ls *.py
fun.py grades.py maths.py people.py pp.py</p>
<p>In [28]: pyscripts = !ls *.py</p>
<p>In [29]: pyscripts
Out[29]: [&lsquo;fun.py&rsquo;, &lsquo;grades.py&rsquo;, &lsquo;maths.py&rsquo;, &lsquo;people.py&rsquo;, &lsquo;pp.py&rsquo;]
#+END_SRC</p>
<p>iPython provides magic commands for most common shell commands.</p>
<p>#+BEGIN_SRC sh</p>
<p>#+END_SRC</p>
<p>** iPython Direcotry Bookmarking</p>
<p>Great timesaving feature: bookmark directories</p>
<p>#+BEGIN_SRC sh
In [3]: %pwd
Out[3]: &lsquo;/home/chris/vcs/github.com/cs2316/cs2316.github.io/code&rsquo;</p>
<p>In [4]: %cd
/home/chris</p>
<p>In [5]: %bookmark cs2316code ~chris/vcs/github.com/cs2316/cs2316.github.io/code</p>
<p>In [6]: cd cs2316code
(bookmark:cs2316code) -> ~chris/vcs/github.com/cs2316/cs2316.github.io/code
/home/chris/vcs/github.com/cs2316/cs2316.github.io/code
#+END_SRC</p>
<p>** iPython Automagic commands</p>
<p>With ~automagic~ turned on, some shell commands can be run as if they were built into iPython:</p>
<p>#+BEGIN_SRC sh
In [22]: pwd
Out[22]: &lsquo;/Users/chris/cs2316&rsquo;</p>
<p>In [23]: ls *.py
fun.py grades.py maths.py people.py pp.py
#+END_SRC</p>
<ul>
<li>
<p>Toggle automagic on and off with ~%automagic~.</p>
</li>
<li>
<p>These commands work with automagic:</p>
<ul>
<li>~%cd~, ~%cat~, ~%cp~, ~%env~, ~%ls~, ~%man~, ~%mkdir~, ~%more~, ~%mv~, ~%pwd~, ~%rm~, and ~%rmdir~</li>
</ul>
</li>
</ul>
<p>** Timing Code in iPython</p>
<p>#+BEGIN_SRC sh
In [23]: import numpy as np</p>
<p>In [24]: pylist = list(range(1, 100000))</p>
<p>In [25]: nparray = np.arange(1, 1000000)</p>
<p>In [35]: %timeit _ = [x * 2 for x in pylist]
100 loops, best of 3: 7.89 ms per loop</p>
<p>In [37]: %timeit _ = nparray.copy() * 2
100 loops, best of 3: 3.76 ms per loop
#+END_SRC</p>
<p>Notice that I copied the Numpy array before applying the ~* 2~ operation to make the comparison to the Python list comprehension fair. You&rsquo;ll learn why when we discuss Numpy in the next lecture.</p>
<p>** Profiling a Script</p>
<p>#+BEGIN_SRC sh
In [7]: %run -p -l 10 -s cumulative funcalc.py
2673375 function calls (1147466 primitive calls) in 1.691 seconds</p>
<p>Ordered by: cumulative time
List reduced from 56 to 10 due to restriction &lt;10></p>
<p>ncalls tottime percall cumtime percall filename:lineno(function)
2/1 0.000 0.000 1.691 1.691 {built-in method builtins.exec}
1 0.000 0.000 1.691 1.691 :1()
1 0.000 0.000 1.691 1.691 interactiveshell.py:2431(safe_execfile)
1 0.000 0.000 1.691 1.691 py3compat.py:182(execfile)
1 0.000 0.000 1.690 1.690 funcalc.py:1()
1 0.000 0.000 1.689 1.689 funcalc.py:46(main)
1 0.039 0.039 1.689 1.689 funcalc.py:34(profile)
510961/10000 0.510 0.000 0.603 0.000 funcalc.py:14(sub)
510961/10000 0.514 0.000 0.598 0.000 funcalc.py:6(add)
510961/10000 0.340 0.000 0.340 0.000 funcalc.py:22(mult)
#+END_SRC</p>
<ul>
<li>~-p~ means profile</li>
<li>~-l 10~ means show only 10 lines</li>
<li>~-s cumulative~ means sort by cumulative time</li>
</ul>
<p>** Profiling a Function</p>
<p>~%prun~ profiles a function. Uses same options as ~% run -p~.</p>
<p>#+BEGIN_SRC python
In [10]: %prun -l 10 -s cumulative funcalc.profile()
2673429 function calls (1148052 primitive calls) in 1.726 seconds</p>
<p>Ordered by: cumulative time
List reduced from 15 to 10 due to restriction &lt;10></p>
<p>ncalls tottime percall cumtime percall filename:lineno(function)
1 0.000 0.000 1.726 1.726 {built-in method builtins.exec}
1 0.000 0.000 1.726 1.726 :1()
1 0.042 0.042 1.726 1.726 funcalc.py:34(profile)
511231/10000 0.537 0.000 0.620 0.000 funcalc.py:6(add)
511231/10000 0.523 0.000 0.615 0.000 funcalc.py:14(sub)
511231/10000 0.336 0.000 0.336 0.000 funcalc.py:22(mult)
20000 0.019 0.000 0.097 0.000 random.py:223(randint)
501231 0.092 0.000 0.092 0.000 funcalc.py:15(dec)
501231 0.082 0.000 0.082 0.000 funcalc.py:7(inc)
20000 0.036 0.000 0.078 0.000 random.py:179(randrange)
#+END_SRC</p>
<p>** Interactive Debugging in iPython</p>
<p>#+BEGIN_SRC python</p>
<p>#+END_SRC</p>
<p>Enter a debug session with ~%debug~ &mldr;</p>
<p>#+BEGIN_SRC python</p>
<p>#+END_SRC</p>
</main>
<script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script>
</body>
</html>