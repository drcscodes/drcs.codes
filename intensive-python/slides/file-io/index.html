<!doctype html><html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Dr. CS codes File IO</title>
<meta name=viewport content="width=device-width">
<link rel=stylesheet href=http://DrCS.codes//css/syntax.css>
<link rel=stylesheet href=http://DrCS.codes//css/main.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=http://DrCS.codes//css/navbar-top-fixed.css rel=stylesheet>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
<a class=navbar-brand href=/intensive-python></a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="navbar-collapse collapse" id=navbarCollapse>
<ul class="navbar-nav mr-auto">
<li class=nav-item><a class=nav-link href=/intensive-python/getting-started/>Getting Started</a></li>
<li class=nav-item><a class=nav-link href=/intensive-python/lessons/>Lessons</a></li>
</ul>
<ul class="navbar-nav pull-right">
<li class="nav-item pull-right"><a class=nav-link href=http://DrCS.codes/>Dr. CS codes</a></li>
</ul>
</div>
</nav>
<main role=main class=container>
<ul>
<li>File Input/Output</li>
</ul>
<p>** Text File IO</p>
<ul>
<li>File IO is done in Python with the built-in ~File~ object which is returned by the built-in ~open~ function</li>
<li>Use the &lsquo;w&rsquo; open mode for writing</li>
</ul>
<p>#+BEGIN_SRC python
$ python</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(&ldquo;hello.txt&rdquo;,&ldquo;w&rdquo;) # open for writing, create if necessary
f.write(&ldquo;Hello, file!\n&rdquo;) # write string to file; notice \n ending
f.close() # close file, causing it to write to disk
exit()
$ cat hello.txt
Hello, file!
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>Use the ’r’ open mode for reading</p>
<p>#+BEGIN_SRC python
$ python</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(&ldquo;hello.txt&rdquo;, &ldquo;r&rdquo;) # open for reading in text mode
contents = f.read()</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id=slurp-the-whole-file-into-memory>slurp the whole file into memory</h1>
<blockquote>
<blockquote>
<blockquote>
<p>contents
&lsquo;Hello, file!\n&rsquo;
exit()
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>** Reading Lines from Text Files</p>
<ul>
<li>Text files often have data split into lines</li>
<li>the ~readlines()~ function reads all lines into memory as a list</li>
</ul>
<p>#+BEGIN_SRC python</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(&ldquo;lines.txt&rdquo;, &ldquo;r&rdquo;)
f.readlines()
[&ldquo;line 1\n&rdquo;, &ldquo;line 2\n&rdquo;, &ldquo;line 3\n&rdquo;]
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<ul>
<li>~readline()~ reads one line at a time, returns empty string when fully read</li>
<li>re-open file or use seek() to go back to beginning of file</li>
</ul>
<p>#+BEGIN_SRC python</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(&ldquo;lines.txt&rdquo;, &ldquo;r&rdquo;)
f.readline()
&lsquo;line 1\n&rsquo;
f.readline()
&lsquo;line 2\n&rsquo;
f.readline()
&lsquo;line 3\n&rsquo;
f.readline()
''
f.seek(0)
f.readline()
&lsquo;line 1\n&rsquo;
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>** Processing Lines in a Text File</p>
<p>Could use readlines() and iterate through list it returns</p>
<p>#+BEGIN_SRC python</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(&ldquo;lines.txt&rdquo;, &ldquo;r&rdquo;)
for line in f.readlines():
&mldr; print line
&mldr;
line 1
line 2
line 3
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>Better to take advantage of fact ~File~ is ~Iterable~</p>
<p>#+BEGIN_SRC python</p>
<blockquote>
<blockquote>
<blockquote>
<p>for line in open(&ldquo;lines.txt&rdquo;, &ldquo;r&rdquo;):
&mldr; print line
&mldr;
line 1
line 2
line 3
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>** Files are Buffered</p>
<p>Try a little experiment. create a subdirectory named foo, cd to your new empty ~foo~ directory, lauch a Python shell, create open a new file named bar, and write something to it:</p>
<p>#+BEGIN_SRC python
$ mkdir foo
$ cd foo
$ python3
Python 3.4.0 (v3.4.0:04f714765c13, Mar 15 2014, 23:02:41) &mldr;</p>
<blockquote>
<blockquote>
<blockquote>
<p>bar = open(&ldquo;bar&rdquo;, &ldquo;w&rdquo;)
bar.write(&ldquo;last call!")
10</p>
</blockquote>
</blockquote>
</blockquote>
<p>#+END_SRC</p>
<p>At this point, open another command shell or use your graphical file
explorer to view the contents of the bar file. It’s empty. Now go back to
your Python shell and do:</p>
<p>#+BEGIN_SRC python</p>
<blockquote>
<blockquote>
<blockquote>
<p>bar.close()
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>Now view the contents of the ~bar~ file again. It has the text from the previous ~write()~ call. Files are buffered, and the buffer isn’t (guaranteed to be) flushed to disk until the file object is closed or the ~File~ Object goes out of scope or the program terminates (gracefully).</p>
<p>** Context Management with ~with~</p>
<p>Python has context managers to close resources automatically. A context manager has the form</p>
<p>#+BEGIN_QUOTE
#+BEGIN_VERBATIM
with expression as variable:
block
#+END_VERBATIM
#+END_QUOTE</p>
<p>which is equivalent to</p>
<p>#+BEGIN_QUOTE
#+BEGIN_VERBATIM
variable = expression
block
variable.close()
#+END_VERBATIM
#+END_QUOTE</p>
<p>For example, the previous bar example is:</p>
<p>#+BEGIN_SRC python</p>
<blockquote>
<blockquote>
<blockquote>
<p>with open(&ldquo;bar&rdquo;, &ldquo;w&rdquo;) as bar:
&mldr; bar.write(&ldquo;last call!")
&mldr;
#+END_SRC</p>
</blockquote>
</blockquote>
</blockquote>
<p>And the file is closed and flushed to disk automatically after the block under the with statement finishes.</p>
<h1 id=-listing-files-in-a-directory>** Listing Files in a directory</h1>
<h1 id=begin_src-python>#+BEGIN_SRC python</h1>
<h1 id=import-os>import os</h1>
<h1 id=dir--some_dir>dir = &lsquo;some_dir&rsquo;</h1>
<h1 id=for-path-in-oslistdirdir>for path in os.listdir(dir):</h1>
<h1 id=if-ospathisdirsubmission_dir>if os.path.isdir(submission_dir):</h1>
<h1 id=printpath-->print(path + &lsquo;/')</h1>
<h1 id=else>else:</h1>
<h1 id=printpath>print(path)</h1>
<h1 id=end_src>#+END_SRC</h1>
<h1 id=-moving-and-copying-files>** Moving and Copying Files</h1>
<h1 id=begin_src-python-1>#+BEGIN_SRC python</h1>
<h1 id=import-shutil>import shutil</h1>
<h1 id=shutilmovesource-destination>shutil.move(source, destination)</h1>
<h1 id=shutilcopysource-destination>shutil.copy(source, destination)</h1>
<h1 id=end_src-1>#+END_SRC</h1>
<h1 id=making-directories>Making directories</h1>
<h1 id=begin_src-python-2>#+BEGIN_SRC python</h1>
<h1 id=import-shutil-1>import shutil</h1>
<h1 id=dir--some_dir-1>dir = &lsquo;some_dir&rsquo;</h1>
<h1 id=shutilmkdirdir>shutil.mkdir(dir)</h1>
<h1 id=end_src-2>#+END_SRC</h1>
</main>
<script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script>
</body>
</html>