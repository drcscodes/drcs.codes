\documentclass[10pt]{exam}

\usepackage[utf8]{inputenc}
\usepackage{verbatim, multicol, tabularx, graphicx, float, xcolor, colortbl}
\usepackage{amsmath,amsthm, amssymb, latexsym, listings, qtree}

\lstset{frame=tb,
  language=Java,
  aboveskip=1mm,
  belowskip=0mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\ttfamily},
  numbers=none,
  frame=single,
  breaklines=true,
  breakatwhitespace=true
}

\textwidth = 6.5 in
\textheight = 9 in
\oddsidemargin = 0.0 in
\evensidemargin = 0.0 in
\topmargin = -0.25 in
\headheight = 0.0 in
\headsep = 0.0 in
\parskip = 0.0in
\parindent = 0.0in

\def\ojoin{\setbox0=\hbox{$\bowtie$}%
  \rule[-.02ex]{.25em}{.4pt}\llap{\rule[\ht0]{.25em}{.4pt}}}
\def\leftouterjoin{\mathbin{\ojoin\mkern-5.8mu\bowtie}}
\def\rightouterjoin{\mathbin{\bowtie\mkern-5.8mu\ojoin}}
\def\fullouterjoin{\mathbin{\ojoin\mkern-5.8mu\bowtie\mkern-5.8mu\ojoin}}

\def\a{& $\blacksquare\blacksquare\blacksquare$ & [ B ] & [ C ] & [ D ] \\}
\def\b{& [ A ] & $\blacksquare\blacksquare\blacksquare$ & [ C ] & [ D ] \\}
\def\c{& [ A ] & [ B ] & $\blacksquare\blacksquare\blacksquare$ & [ D ] \\}
\def\d{& [ A ] & [ B ] & [ C ] & $\blacksquare\blacksquare\blacksquare$ \\}



\title{Databases Final Exam Practice}
\date{ER-Relational Mapping, SQL, Relational Design, Physical DMBS Design}
\setcounter{page}{1}
\begin{document}

\maketitle
\thispagestyle{empty}
\firstpageheader{}               {\tiny Copyright \textcopyright\ 2016 All rights reserved. Duplication and/or usage for purposes of any kind without permission is strictly forbidden.}
                {}


\runningheader{}
{\small Name: \underline{\hspace{2.8in}} NetID (e.g., msmith3): \underline{\hspace{1.4in}}}
{}

%% \footer{Page \thepage\ of \numpages}
%%               {}
%%               {Points available: \pointsonpage{\thepage} -
%%                points lost: \makebox[.5in]{\hrulefill} =
%%                points earned:  \makebox[.5in]{\hrulefill}.
%%               Graded by: \makebox[.5in]{\hrulefill}}


\ifprintanswers
\begin{center}
{\LARGE ANSWER KEY}
\end{center}
\vspace{.25in}
\else
\vspace{0.1in}
\hbox to \textwidth{Name: \enspace\hrulefill}
\vspace{0.2in}
\hbox to \textwidth{GT account (gtg, gth, msmith3, etc): \underline{\hspace{2in}} Section (e.g., B1): \underline{\hspace{.75in}}}
\vspace{0.2in}
\hbox to \textwidth{Signature: \enspace\hrulefill}

\vfill

\begin{itemize}
\item Failure to properly fill in the information on this page will result in a deduction of up to 4 points from your exam score.
\item Signing signifies that you agree to comply with the {\bf Academic Honor Code of Georgia Tech}.
\item Calculators and cell phones are NOT allowed.
\end{itemize}

\fi


% Points Table
%\begin{center}
%\addpoints
%\gradetable[v][pages]
%\end{center}

Completely fill in the box corresponding to your answer choice for each question.

\ifprintanswers
DISREGARD THESE ANSWERS.  LOOK AT THE QUESTIONS.
\begin{tabular}{lcccc}\\
  1. \c
  2. \c
  3. \c
  4. \a
  5. \d
  6. \c
  7. \b
  8. \a
  9. \b
  10. \c
  11. \d
  12. \c
  13. \d
  14. \a
  15. \a
  16. \b
  17. \d
  18. \d
  19. \a
  20. \b
  21. \b
  22. \b
  23. \b
  24. \b
  25. \b
\end{tabular}
\else
\begin{tabular}{lcccc}\\
  1. & [ A ] & [ B ] & [ C ] & [ D ] \\
  2. & [ A ] & [ B ] & [ C ] & [ D ] \\
  3. & [ A ] & [ B ] & [ C ] & [ D ] \\
  4. & [ A ] & [ B ] & [ C ] & [ D ] \\
  5. & [ A ] & [ B ] & [ C ] & [ D ] \\
  6. & [ A ] & [ B ] & [ C ] & [ D ] \\
  7. & [ A ] & [ B ] & [ C ] & [ D ] \\
  8. & [ A ] & [ B ] & [ C ] & [ D ] \\
  9. & [ A ] & [ B ] & [ C ] & [ D ] \\
  10. & [ A ] & [ B ] & [ C ] & [ D ] \\
  11. & [ A ] & [ B ] & [ C ] & [ D ] \\
  12. & [ A ] & [ B ] & [ C ] & [ D ] \\
  13. & [ A ] & [ B ] & [ C ] & [ D ] \\
  14. & [ A ] & [ B ] & [ C ] & [ D ] \\
  15. & [ A ] & [ B ] & [ C ] & [ D ] \\
  16. & [ A ] & [ B ] & [ C ] & [ D ] \\
  17. & [ A ] & [ B ] & [ C ] & [ D ] \\
  18. & [ A ] & [ B ] & [ C ] & [ D ] \\
  19. & [ A ] & [ B ] & [ C ] & [ D ] \\
  20. & [ A ] & [ B ] & [ C ] & [ D ] \\
  21. & [ A ] & [ B ] & [ C ] & [ D ] \\
  22. & [ A ] & [ B ] & [ C ] & [ D ] \\
  23. & [ A ] & [ B ] & [ C ] & [ D ] \\
  24. & [ A ] & [ B ] & [ C ] & [ D ] \\
  25. & [ A ] & [ B ] & [ C ] & [ D ] \\
\end{tabular}

\fi

\vspace{.5in}

Number missed: \makebox[.5in]{\hrulefill} Written Score: \makebox[.5in]{\hrulefill}

\newpage

\newpage

\pointsinmargin
\bracketedpoints

\marginpointname{}

Refer to the following EER diagram for Questions 1 -- 7

\begin{center}
  \hspace{-.5in}\includegraphics[width=7in]{humane-society.png}
\end{center}

\newpage

\begin{questions}

\question Which of the following (sets of) relation schemas is a correct mapping of the SHELTER entity type? (Disregard the MANAGES relationship.)

\begin{choices}
\choice SHELTER(\underline{SID}, Number, Street, City, State, Zip, DaysOpen, Phones)
\choice SHELTER(\underline{SID}, Number, Street, City, State, Zip, Phones), DaysOpen(\underline{SID, Day})
\correctchoice SHELTER(\underline{SID}, Number, Street, City, State, Zip), DaysOpen(\underline{SID, Day}), Phones(\underline{SID, Phone})
\choice All of the above.
\end{choices}

\question Which of the following relation schemas is a correct mapping of the PET entity type?

\begin{choices}
\choice PET(\underline{PID}, Name, Species, BirthDate, Age)
\choice PET(\underline{PID}, Name, Species, BirthDate)
\correctchoice PET(\underline{PID, SID}, Name, Species, BirthDate)
\choice None of the above
\end{choices}

\question Which of the following sets of relation schemas is a correct mapping of the WORKS\_FOR relationship (Disregard multivalued attributes of SHELTER.)?

\begin{choices}
\choice WORKER(\underline{SSN}, Name, Phone, SID), SHELTER(\underline{SID}, Number, Street, City, State, Zip)
\choice WORKER(\underline{SSN}, Name, Phone), SHELTER(\underline{SID}, Number, Street, City, State, Zip, SSN)
\correctchoice WORKER\_SHELTER(\underline{SSN, SID}), WORK\_DAYS(\underline{SSN, SID, Day})
\choice WORKER\_SHELTER(\underline{SSN, SID}, Days)
\end{choices}

\question What's the least number of tables necessary to model the WORKER - VOLUNTEER - EMPLOYEE - MANAGER class hierarchy?

\begin{choices}
\correctchoice 1
\choice 2
\choice 3
\choice 4
\end{choices}

\question Which of the following sets of relation schemas acceptably represenents the WORKER - VOLUNTEER - EMPLOYEE - MANAGER class hierarchy?

\begin{choices}
\choice WORKER(SSN, Name, Phone), VOLUNTEER(SSN), EMPLOYEE(SSN,PayRate), MANAGER(SSN)
\choice EMPLOYEE(SSN, Name, Phone, PayRate, IsManager), VOLUNTEER(SSN)
\choice WORKER(SSN, Name, Phone, PayRate, IsManager)
\correctchoice All of the above.
\end{choices}


\question Which of the following create table statements creates a PET table that accurately models the PET entity type?

\begin{choices}
\choice create table pet(PID int primary key, Name varchar(20), Species varchar(20), Birthdate date)
\choice create table pet(PID int primary key, Name varchar(20), Species varchar(20), Birthdate date, SID int)
\correctchoice create table pet(PID int, Name varchar(20), Species varchar(20), Birthdate date, SID int, primary key (PID, SID), foreign key (SID) references shelter(SID))
\choice None of the above.
\end{choices}

\question Which of the following create table statements creates a table that accurately models the WORKS\_FOR relationship? (Disregard multivalued attributes.)

\begin{choices}
\choice create table worker\_shelter(SSN int, SID int, days enum (M, Tu, W, Th, F))
\correctchoice create table worker\_shelter(SSN int, SID int, primary key (SSN, SID), foreign key (SSN) references worker (SSN), foreign key (SID) references shelter (SID))
\choice create table worker\_shelter(SSN int, SID int, primary key (SSN))
\choice None of the above.
\end{choices}

\newpage

Refer to the following create table statements and table data for Questions 8 -- 10.

\begin{lstlisting}[language=sql]
create table dorm (
    dorm_id integer primary key auto_increment,
    name text not null,
    spaces integer
);


create table student (
    student_id integer primary key auto_increment,
    name text,
    gpa float(3,2),
    dorm_id integer not null,
    foreign key (dorm_id) references dorm(dorm_id)
);
\end{lstlisting}


\begin{verbatim}
mysql> select * from dorm;
+---------+-----------+--------+
| dorm_id | name      | spaces |
+---------+-----------+--------+
|       1 | Armstrong |    124 |
|       2 | Brown     |    158 |
+---------+-----------+--------+
2 rows in set (0.00 sec)

mysql> select * from student;
+------------+-------+------+---------+
| student_id | name  | gpa  | dorm_id |
+------------+-------+------+---------+
|          1 | Alice | 3.60 |       1 |
|          2 | Bob   | 2.70 |       1 |
+------------+-------+------+---------+
2 rows in set (0.00 sec)

\end{verbatim}

\question Which of the following insert statements will succeed?

\begin{choices}
\correctchoice {\tt insert into dorm (name, spaces) values('Caldwell', 158);}
\choice {\tt insert into dorm values('Caldwell', 158);}
\choice {\tt insert into dorm (name, spaces) values(null, 158);}
\choice All of the above.
\end{choices}

\question Which of the following insert statement is certain to succeed?

\begin{choices}
\choice {\tt insert into student (name, gpa, dorm\_id) values ('Cheng', 3.6, 3);}
\correctchoice {\tt insert into student (name, gpa, dorm\_id) values ('Cheng', 3.6, 1);}
\choice {\tt insert into student (name, gpa) values ('Cheng', 3.6);}
\choice All of the above.
\end{choices}

\question Which of the following delete statements will fail?

\begin{choices}
\choice {\tt delete from student}
\choice {\tt delete from dorm where name = 'Brown';}
\correctchoice {\tt delete from dorm where name = 'Armstrong';}
\choice None of the above.
\end{choices}

\newpage


\begin{figure}[H]

\section*{Pubs Database Schema}

$author(\underline{author\_id}, first\_name, last\_name)$\\

$author\_pub(\underline{author\_id}, \underline{pub\_id}, author\_position)$\\

$book(\underline{book\_id}, title, month, year, editor)$\\

$pub(\underline{pub\_id}, title, book\_id)$

\begin{itemize}
\item $author\_id$ in $author\_pub$ is a foreign key referencing $author$
\item $pub\_id$ in $author\_pub$ is a foreign key referencing $pub$
\item $book\_id$ in $pub$ is a foreign key referencing $book$
\item $editor$ in $book$ is a foreign key referencing $author(author\_id)$
\item Primary keys are underlined
\end{itemize}

\section*{Pubs Database State}

\begin{multicols}{2}

$r(author)$\\
\begin{tabular}{|l|l|l|}\hline
\rowcolor{lightgray} author\_id & first\_name & last\_name \\\hline
1 & John       & McCarthy  \\\hline
2 & Dennis     & Ritchie   \\\hline
3 & Ken        & Thompson  \\\hline
4 & Claude     & Shannon   \\\hline
5 & Alan       & Turing    \\\hline
6 & Alonzo     & Church    \\\hline
7 & Perry      & White     \\\hline
8 & Moshe      & Vardi     \\\hline
9 & Roy        & Batty     \\\hline
\end{tabular}

\columnbreak

$r(author\_pub)$\\
\begin{tabular}{|l|l|l|}\hline
\rowcolor{lightgray} author\_id & pub\_id & author\_position \\\hline
1 &      1 &      1 \\\hline
2 &      2 &      1 \\\hline
3 &      2 &      2 \\\hline
4 &      3 &      1 \\\hline
5 &      4 &      1 \\\hline
5 &      5 &      1 \\\hline
6 &      6 &      1 \\\hline
\end{tabular}
\end{multicols}

\begin{multicols}{2}

$r(book)$\\
\begin{tabular}{|l|l|l|l|l|}\hline
\rowcolor{lightgray} book\_id & title & month    & year & editor \\\hline
       1 & CACM       & April    & 1960 &      8 \\\hline
       2 & CACM       & July     & 1974 &      8 \\\hline
       3 & BST        & July     & 1948 &      2 \\\hline
       4 & LMS        & November & 1936 &      7 \\\hline
       5 & Mind       & October  & 1950 &   NULL \\\hline
       6 & AMS        & Month    & 1941 &   NULL \\\hline
       7 & AAAI       & July     & 2012 &      9 \\\hline
       8 & NIPS       & July     & 2012 &      9 \\\hline
\end{tabular}

\columnbreak

$r(pub)$\\
\begin{tabular}{|l|l|l|}\hline
\rowcolor{lightgray} pub\_id & title           & book\_id \\\hline
     1 & LISP            &       1 \\\hline
     2 & Unix            &       2 \\\hline
     3 & Info Theory     &       3 \\\hline
     4 & Turing Machines &       4 \\\hline
     5 & Turing Test     &       5 \\\hline
     6 & Lambda Calculus &       6 \\\hline
\end{tabular}

\end{multicols}



\caption{Pubs Database}
\label{fig:pubs-db}
\end{figure}

\newpage

For the questions on this page, refer to Figure~\ref{fig:pubs-db}.

\question Query giving author first name and last name who have published in CACM.

\begin{solution}[1in]
Download and install the pubs database on your computer to check your answer.
\end{solution}

\question Query giving all authors and the books they have edited, including authors who are not book editors.

\begin{solution}[1in]
Download and install the pubs database on your computer to check your answer.
\end{solution}

\question Query giving all author first names and last names who have published more than one pub.

\begin{solution}[1in]
Download and install the pubs database on your computer to check your answer.
\end{solution}

\question Author of the oldest pub in the database.

\begin{solution}[1in]
Download and install the pubs database on your computer to check your answer.
\end{solution}

\question How many rows returned by {\tt select * from book natural join pub}?

\begin{solution}[1in]
Download and install the pubs database on your computer to check your answer.
\end{solution}


\newpage

Relational Design

\question Given the following relation schemas and functional dependencies:

LOTS1(PropertyiId , CountyName, Lot, Area, Price)\\
LOTS2(CountyName , TaxRate)

\begin{itemize}
\item FD1: PropertyId $\rightarrow$ CountyName, Lot, Area, Price, TaxRate
\item FD2: CountyName, Lot $\rightarrow$ PropertyId, Area, Price, TaxRate
\item FD3: CountyName $\rightarrow$ TaxRate
\item FD4: Area $\rightarrow$ Price
\end{itemize}

What is the highest normal form satified by these schemas?

\begin{choices}
\choice 1NF
\correctchoice 2NF
\choice 3NF
\choice BCNF
\end{choices}

\question Given the following relation schemas and functional dependencies:

LOTS1A(PropertyId, CountyName, Lot, Area)\\
LOTS1B(Area, Price)\\
LOTS2(CountyName, TaxRate)

\begin{itemize}
\item FD1: PropertyId $\rightarrow$ CountyName, Lot, Area
\item FD2: CountyName, Lot $\rightarrow$ PropertyId, Area
\item FD3: CountyName $\rightarrow$ TaxRate
\item FD4: Area $\rightarrow$ Price
\end{itemize}


What is the highest normal form satified by these schemas?

\begin{choices}
\choice 1NF
\choice 2NF
\correctchoice 3NF
\choice BCNF
\end{choices}


\question Given the following relation schemas and functional dependencies:

R1(Instructor , Course)\\
R2(Instructor, Student)

\begin{itemize}
\item FD1: Student, Course $\rightarrow$ Instructor
\item FD2: Instructor $\rightarrow$ Course.
\end{itemize}

What is the highest normal form satified by these schemas?

\begin{choices}
\choice 1NF
\choice 2NF
\choice 3NF
\correctchoice BCNF
\end{choices}


\newpage

Physical DMBS Design

\question How is data stored in a log-structured storage engine, e.g., LSM-trees?

\begin{choices}
\correctchoice Files containing append-only sequences of records
\choice B-trees
\choice B$^+$-trees
\choice Hashes
\end{choices}

\question How is data stored in a page-oriented storage engine?

\begin{choices}
\correctchoice A sorted, balanced, tree-structured collection of fixed-size blocks, or pages, such as a B-tree.
\choice Hash tables
\choice Inverted splay trees
\choice File cabinets
\end{choices}

\question What is the primary trade-off of indexes in terms of read vs. write performance?

\begin{choices}
\correctchoice Indexes speed up reads but slow down writes.
\choice Indexes speed up writes but slow down reads.
\choice Indexes speed up both reads and writes.
\choice Indexes slow down both reads and writes.
\end{choices}

\question Which of the following techniques limits the size of data files in a database that uses LSM-trees?

\begin{choices}
\correctchoice Compaction
\choice Coercion
\choice Conflagration
\end{choices}

\question Which of the following techniques makes B-trees more reliable (reslient to crashes)?

\begin{choices}
\choice Writing every modification to the database to a {\it write-ahead log (WAL)} before applying changes to the B-tree.
\choice Using latches (lightweight locks) to control concurrent access to the B-tree.
\correctchoice All of the above
\end{choices}

\question Which of the following are advantages of LSM-trees compared to B-trees?

\begin{choices}
\choice LSM-trees are usually faster for writes.
\choice LSM-trees usually support higher write throughput.
\choice LSM-trees usually use less disk space due to better compression and less fragmentation (e.g., unused space in blocks in a B-tree).
\correctchoice All of the above
\end{choices}

\question Which of the following are advantages of B-trees compared to LSM-trees?

\begin{choices}
\choice Reads are usually faster on B-trees.
\choice More predictable performance.  In LSM-trees compaction processes can lead to unpredictable temprary performance degradation.
\choice B-trees better support transaction processing because each key exists in only one place in the index, so transaction isolation can be implemented with locks on small ranges of keys that can be directly attached to the tree.
\correctchoice All of the above
\end{choices}

\newpage

\question Which of the following acronyms refers to safety guarantees provided by transactions?

\begin{choices}
\correctchoice ACID
\choice BASE
\choice PH
\end{choices}

\question Which of the following best describes the {\it atomicity} property of database transactions?

\begin{choices}
\correctchoice The writes in a transaction either all succeed (transaction is {\it committed}) or all fail (transaction is {\it rolled back} or {\it aborted}).
\choice Invariants, i.e., statements about data, that are true before a transactoin remain true afterwards.
\choice Concurrently executing transactions are isolated from each other, i.e., they don't interfere with each other.
\choice The promise that once a transaction has committed successfully, any data it has written will not be forgotten, even if there is a hardware fault or the database crashes.
\end{choices}

\question Which of the following best describes the {\it consistency} property of database transactions?

\begin{choices}
\choice The writes in a transaction either all succeed (transaction is {\it committed}) or all fail (transaction is {\it rolled back} or {\it aborted}).
\correctchoice Invariants, i.e., statements about data, that are true before a transactoin remain true afterwards.
\choice Concurrently executing transactions are isolated from each other, i.e., they don't interfere with each other.
\choice The promise that once a transaction has committed successfully, any data it has written will not be forgotten, even if there is a hardware fault or the database crashes.
\end{choices}

\question Which of the following best describes the {\it isolation} property of database transactions?

\begin{choices}
\choice The writes in a transaction either all succeed (transaction is {\it committed}) or all fail (transaction is {\it rolled back} or {\it aborted}).
\choice Invariants, i.e., statements about data, that are true before a transactoin remain true afterwards.
\correctchoice Concurrently executing transactions are isolated from each other, i.e., they don't interfere with each other.
\choice The promise that once a transaction has committed successfully, any data it has written will not be forgotten, even if there is a hardware fault or the database crashes.
\end{choices}

\question Which of the following best describes the {\it durability} property of database transactions?

\begin{choices}
\choice The writes in a transaction either all succeed (transaction is {\it committed}) or all fail (transaction is {\it rolled back} or {\it aborted}).
\choice Invariants, i.e., statements about data, that are true before a transactoin remain true afterwards.
\choice Concurrently executing transactions are isolated from each other, i.e., they don't interfere with each other.
\correctchoice The promise that once a transaction has committed successfully, any data it has written will not be forgotten, even if there is a hardware fault or the database crashes.
\end{choices}

\end{questions}

\end{document}
