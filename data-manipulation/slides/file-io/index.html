<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes File IO</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/data-manipulation>File IO</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>File Input/Output</h2><div id=outline-text-headline-1 class=outline-text-2><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2>Text File IO</h3><div id=outline-text-headline-2 class=outline-text-3><ul><li>File IO is done in Python with the built-in <code>File</code> object which is returned by the built-in <code>open</code> function</li><li>Use the 'w' open mode for writing</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;hello.txt&#34;</span>,<span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#75715e># open for writing, create if necessary</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;Hello, file!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>) <span style=color:#75715e># write string to file; notice \n ending</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>close()                 <span style=color:#75715e># close file, causing it to write to disk</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> exit()
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> cat hello<span style=color:#f92672>.</span>txt
</span></span><span style=display:flex><span>Hello, file<span style=color:#960050;background-color:#1e0010>!</span></span></span></code></pre></div></div><p>Use the ’r’ open mode for reading</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;hello.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#75715e># open for reading in text mode</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> contents <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span><span style=color:#75715e># slurp the whole file into memory</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> contents
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;Hello, file!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> exit()</span></span></code></pre></div></div></div></div><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3>Reading Lines from Text Files</h3><div id=outline-text-headline-3 class=outline-text-3><ul><li>Text files often have data split into lines</li><li>the <code>readlines()</code> function reads all lines into memory as a list</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;lines.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#34;line 1</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;line 2</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;line 3</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>]</span></span></code></pre></div></div><ul><li><code>readline()</code> reads one line at a time, returns empty string when fully read</li><li>re-open file or use seek() to go back to beginning of file</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;lines.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;line 1</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;line 2</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;line 3</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>seek(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;line 1</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-4 class=outline-3><h3 id=headline-4>Processing Lines in a Text File</h3><div id=outline-text-headline-4 class=outline-text-3><p>Could use readlines() and iterate through list it returns</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;lines.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> f<span style=color:#f92672>.</span>readlines():
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     print line
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>line <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>line <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>line <span style=color:#ae81ff>3</span></span></span></code></pre></div></div><p>Better to take advantage of fact <code>File</code> is <code>Iterable</code></p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> open(<span style=color:#e6db74>&#34;lines.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>):
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     print line
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>line <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>line <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>line <span style=color:#ae81ff>3</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-5 class=outline-3><h3 id=headline-5>Files are Buffered</h3><div id=outline-text-headline-5 class=outline-text-3><p>Try a little experiment. create a subdirectory named foo, cd to your new empty <code>foo</code> directory, lauch a Python shell, create open a new file named bar, and write something to it:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> mkdir foo
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> cd foo
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python3
</span></span><span style=display:flex><span>Python <span style=color:#ae81ff>3.4.0</span> (v3<span style=color:#ae81ff>.4.0</span>:<span style=color:#ae81ff>04</span>f714765c13, Mar <span style=color:#ae81ff>15</span> <span style=color:#ae81ff>2014</span>, <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>41</span>) <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> bar <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;bar&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> bar<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;last call!&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span></span></span></code></pre></div></div><p>At this point, open another command shell or use your graphical file
explorer to view the contents of the bar file. It’s empty. Now go back to
your Python shell and do:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> bar<span style=color:#f92672>.</span>close()</span></span></code></pre></div></div><p>Now view the contents of the <code>bar</code> file again. It has the text from the previous <code>write()</code> call. Files are buffered, and the buffer isn’t (guaranteed to be) flushed to disk until the file object is closed or the <code>File</code> Object goes out of scope or the program terminates (gracefully).</p></div></div><div id=outline-container-headline-6 class=outline-3><h3 id=headline-6>Context Management with <code>with</code></h3><div id=outline-text-headline-6 class=outline-text-3><p>Python has context managers to close resources automatically. A context manager has the form</p><blockquote><div class=verbatim-block><p>with expression as variable:
block</p></div></blockquote><p>which is equivalent to</p><blockquote><div class=verbatim-block><p>variable = expression
block
variable.close()</p></div></blockquote><p>For example, the previous bar example is:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;bar&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> bar:
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     bar<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;last call!&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span></span></span></code></pre></div></div><p>And the file is closed and flushed to disk automatically after the block under the with statement finishes.</p></div></div></div></div></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>