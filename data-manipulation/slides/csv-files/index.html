<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes CSV Files</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/data-manipulation>CSV Files</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>CSV Files</h2><div id=outline-text-headline-1 class=outline-text-2><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2>"Comma"-Separated Values Files</h3><div id=outline-text-headline-2 class=outline-text-3><p>Say we have data in a comma-separated values file</p><div class="src src-sh"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ cat capitals.dat <span style=color:#75715e># could be .dat, .csv, or anything</span>
</span></span><span style=display:flex><span>Japan,Tokyo
</span></span><span style=display:flex><span>France,Paris
</span></span><span style=display:flex><span>Germany,Berlin
</span></span><span style=display:flex><span>U.S.A.,Washington, D.C</span></span></code></pre></div></div><p>Can use line-by-line file reading with the split() function we saw earlier to process comma-separated value files</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> capitals <span style=color:#f92672>=</span> {} <span style=color:#75715e># initialize a dictionary to hold our capitals data</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> open(<span style=color:#e6db74>&#39;capitals.dat&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>): <span style=color:#75715e># for each line in file</span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     k, v <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;,&#39;</span>)             <span style=color:#75715e># split into key and value</span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     capitals[k] <span style=color:#f92672>=</span> v                    <span style=color:#75715e># add key:value to dict</span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>Traceback (most recent call last):
</span></span><span style=display:flex><span>File <span style=color:#e6db74>&#34;&lt;stdin&gt;&#34;</span>, line <span style=color:#ae81ff>2</span>, <span style=color:#f92672>in</span> <span style=color:#f92672>&lt;</span>module<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ValueError</span>: too many values to unpack</span></span></code></pre></div></div><p>Why didn't it work?</p></div></div><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3>CSV Separator Characters</h3><div id=outline-text-headline-3 class=outline-text-3><p>We can troubleshoot in the Python interpreter</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> open(<span style=color:#e6db74>&#39;capitals.dat&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>):
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     print line<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;,&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;Japan&#39;</span>, <span style=color:#e6db74>&#39;Tokyo</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>]
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;France&#39;</span>, <span style=color:#e6db74>&#39;Paris</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>]
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;Germany&#39;</span>, <span style=color:#e6db74>&#39;Berlin</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>]
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;U.S.A.&#39;</span>, <span style=color:#e6db74>&#39;Washington&#39;</span>, <span style=color:#e6db74>&#39; D.C</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>]</span></span></code></pre></div></div><p>There's a comma in Washington, D.C. that was taken as a separator So let's change the capitals.dat file to use semicolons as the separators</p><div class="src src-sh"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ cat capitals.dat
</span></span><span style=display:flex><span>Japan;Tokyo
</span></span><span style=display:flex><span>France;Paris
</span></span><span style=display:flex><span>Germany;Berlin
</span></span><span style=display:flex><span>U.S.A.;Washington, D.C</span></span></code></pre></div></div></div></div><div id=outline-container-headline-4 class=outline-3><h3 id=headline-4>CSV Files in Practice</h3><div id=outline-text-headline-4 class=outline-text-3><p>Now our capitals.dat file is readable as a "comma"-separated values file</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> capitals <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> open(<span style=color:#e6db74>&#39;capitals.dat&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>):
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     k, v <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;;&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     capitals[k] <span style=color:#f92672>=</span> v
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> capitals
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;Japan&#39;</span>: <span style=color:#e6db74>&#39; Tokyo</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;U.S.A.&#39;</span>: <span style=color:#e6db74>&#39; Washington, D.C</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;Germany&#39;</span>: <span style=color:#e6db74>&#39;Berlin</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;France&#39;</span>: <span style=color:#e6db74>&#39; Paris</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>}</span></span></code></pre></div></div><ul><li>But the values have leading whitespace and trailing <code>\n</code> characters from the data file</li></ul></div></div><div id=outline-container-headline-5 class=outline-3><h3 id=headline-5>Manually Cleaning CSV Lines</h3><div id=outline-text-headline-5 class=outline-text-3><ul><li>We can make our code more robust with strip(), which removes leading and trailing whitespace and non-printing chars</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> open(<span style=color:#e6db74>&#39;capitals.dat&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>):
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     k, v <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;;&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     capitals[k<span style=color:#f92672>.</span>strip()] <span style=color:#f92672>=</span> v<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> capitals
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;Japan&#39;</span>: <span style=color:#e6db74>&#39;Tokyo&#39;</span>, <span style=color:#e6db74>&#39;U.S.A.&#39;</span>: <span style=color:#e6db74>&#39;Washington, D.C&#39;</span>, <span style=color:#e6db74>&#39;Germany&#39;</span>: <span style=color:#e6db74>&#39;Berlin&#39;</span>, <span style=color:#e6db74>&#39;France&#39;</span>: <span style=color:#e6db74>&#39;Paris&#39;</span>}</span></span></code></pre></div></div><p>But we don't need to go to this trouble …</p></div></div><div id=outline-container-headline-6 class=outline-3><h3 id=headline-6>The csv Module</h3><div id=outline-text-headline-6 class=outline-text-3><p>The best way to process CSV files is with the csv module.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> scripters <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     [<span style=color:#e6db74>&#39;Perl&#39;</span>, <span style=color:#e6db74>&#39;Larry Wall&#39;</span>],
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     [<span style=color:#e6db74>&#39;Python&#39;</span>, <span style=color:#e6db74>&#39;Guido Van Rossum&#39;</span>],
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     [<span style=color:#e6db74>&#39;Ruby&#39;</span>, <span style=color:#e6db74>&#39;Yukihiro Matsumoto&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#f92672>...</span> ]
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;scripters&#39;</span>, <span style=color:#e6db74>&#39;wt&#39;</span>) <span style=color:#66d9ef>as</span> fout:
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvout <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>writer(fout)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvout<span style=color:#f92672>.</span>writerows(scripters)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>^</span>D
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> cat scripters
</span></span><span style=display:flex><span>Perl,Larry Wall
</span></span><span style=display:flex><span>Python,Guido Van Rossum
</span></span><span style=display:flex><span>Ruby,Yukihiro Matsumoto</span></span></code></pre></div></div><ul><li>The with statement creates a context manager</li><li>After the with block ends, the file is automatically closed</li></ul></div></div><div id=outline-container-headline-7 class=outline-3><h3 id=headline-7>Reading CSV Files</h3><div id=outline-text-headline-7 class=outline-text-3><p>We can read our scripters file with</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;scripters&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> fin:
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvin <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>reader(fin)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     scripters <span style=color:#f92672>=</span> [line <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> csvin]
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> scripters
</span></span><span style=display:flex><span>[[<span style=color:#e6db74>&#39;Perl&#39;</span>, <span style=color:#e6db74>&#39;Larry Wall&#39;</span>], [<span style=color:#e6db74>&#39;Python&#39;</span>, <span style=color:#e6db74>&#39;Guido Van Rossum&#39;</span>], [<span style=color:#e6db74>&#39;Ruby&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;Yukihiro Matsumoto&#39;</span>]]
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-8 class=outline-3><h3 id=headline-8>Column Headers in CSV Files</h3><div id=outline-text-headline-8 class=outline-text-3><p>Use a DictReader to store the records from the CSV file in a dict.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;scripters&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> fin:
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvin <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictReader(fin, fieldnames<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;langauge&#39;</span>, <span style=color:#e6db74>&#39;creator&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     scripters <span style=color:#f92672>=</span> [line <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> csvin]
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> scripters
</span></span><span style=display:flex><span>[{<span style=color:#e6db74>&#39;creator&#39;</span>: <span style=color:#e6db74>&#39;Larry Wall&#39;</span>, <span style=color:#e6db74>&#39;langauge&#39;</span>: <span style=color:#e6db74>&#39;Perl&#39;</span>}, {<span style=color:#e6db74>&#39;creator&#39;</span>: <span style=color:#e6db74>&#39;Guido Van Rossum&#39;</span>, <span style=color:#e6db74>&#39;langauge&#39;</span>: <span style=color:#e6db74>&#39;Python&#39;</span>}, {<span style=color:#e6db74>&#39;creator&#39;</span>: <span style=color:#e6db74>&#39;Yukihiro Matsumoto&#39;</span>, <span style=color:#e6db74>&#39;langauge&#39;</span>: <span style=color:#e6db74>&#39;Ruby&#39;</span>}]</span></span></code></pre></div></div></div></div><div id=outline-container-headline-9 class=outline-3><h3 id=headline-9>Writing Dicts to CSV Files</h3><div id=outline-text-headline-9 class=outline-text-3><p>And we can use a DictWriter to write a CSV file with a header line.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;scripters&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> fout:
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvout <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictWriter(fout, fieldnames<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;langauge&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;creator&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvout<span style=color:#f92672>.</span>writeheader()
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     csvout<span style=color:#f92672>.</span>writerows(scripters)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>^</span>D
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> cat scripters
</span></span><span style=display:flex><span>langauge,creator
</span></span><span style=display:flex><span>Perl,Larry Wall
</span></span><span style=display:flex><span>Python,Guido Van Rossum
</span></span><span style=display:flex><span>Ruby,Yukihiro Matsumoto</span></span></code></pre></div></div></div></div><div id=outline-container-headline-10 class=outline-3><h3 id=headline-10>CSV Details</h3><div id=outline-text-headline-10 class=outline-text-3><p>CSV files can be complex.</p><ul><li>Different delimiters can be used.</li><li>Delimiter characters can appear in fields.</li><li>Fields can be surrounded with "quotes".</li><li>Different operating systems may use different line endings.</li></ul><p>The CSV module handles all of these issues for you. Read the <a href=https://docs.python.org/3/library/csv.html>CSV module documentation</a> to become familiar with its capabilities.</p></div></div></div></div></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>