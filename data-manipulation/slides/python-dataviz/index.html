<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes Data Visualization in Python</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/data-manipulation>Data Visualization in Python</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Data Visualization</h2><div id=outline-text-headline-1 class=outline-text-2><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2>Data Visualization</h3><div id=outline-text-headline-2 class=outline-text-3><div id=outline-container-headline-3 class=outline-4><h4 id=headline-3>:BMCOL:B_block:</h4><div id=outline-text-headline-3 class=outline-text-4><p><img src=tufte-vdqi-2ed.png alt=tufte-vdqi-2ed.png title=tufte-vdqi-2ed.png></p></div></div><div id=outline-container-headline-4 class=outline-4><h4 id=headline-4>:BMCOL:B_block:</h4><div id=outline-text-headline-4 class=outline-text-4><blockquote><p>Data graphics visually display measured quantities by means of the combined use of points, lines, a coordinate system, numbers, words, shading, and color.</p></blockquote><p>– Edward Tufte, <em>The Visual Display of Quantitative Information</em></p></div></div></div></div><div id=outline-container-headline-5 class=outline-3><h3 id=headline-5>Data Visualization in Python</h3><div id=outline-text-headline-5 class=outline-text-3><p>You already know basic concepts of visualization, and there are many courses that go in depth. Here we'll learn how to manipulate the data and parameters of the visualizations available in the SciPy stack.</p><ul><li><p>Matplotlib</p><ul><li>Matlab-like plotting interface</li><li>The granddaddy of all scientific plotting in Python</li><li>Powerful, low-level</li><li>Built on NumPy arrays</li></ul></li><li><p>Seaborn</p><ul><li>Higher-level API on top of Matplotlib</li><li>Integrates with Pandas DataFrames</li></ul></li><li><p>Bokeh or Plotly/Dash</p><ul><li>Interactive visualizations like D3</li></ul></li></ul></div></div><div id=outline-container-headline-6 class=outline-3><h3 id=headline-6>Matplotlib</h3><div id=outline-text-headline-6 class=outline-text-3><p>Standard import:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt</span></span></code></pre></div></div><p>Three contexts:</p><ul><li><p>Python script: (example)</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>xs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>100</span>) <span style=color:#75715e># 100 evenly spaced points in [0,10]</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(xs, np<span style=color:#f92672>.</span>sin(xs))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(xs, np<span style=color:#f92672>.</span>cos(xs))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()</span></span></code></pre></div></div><p>After constructing plot, call <code>plt.show()</code> only once, typically at end of script. Result of calling <code>plt.show()</code> multiple times is undefined.</p></li><li><p>iPython: (I've had better luck with the qt5 backend.)</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>4</span>]: <span style=color:#f92672>%</span>matplotlib qt5</span></span></code></pre></div></div><p>Now any plot command opens a figure window. Force redraw with <code>plt.draw()</code>.</p></li><li><p>Jupyter Notebook, two options:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>%</span>matplotlib notebook</span></span></code></pre></div></div><p>Embed interactive plots in notebook.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>%</span>matplotlib inline</span></span></code></pre></div></div><p>Embed static plot images in notebook. We'll usually use this option.</p></li></ul></div></div><div id=outline-container-headline-7 class=outline-3><h3 id=headline-7>Matlab-style Interface</h3><div id=outline-text-headline-7 class=outline-text-3><p>It's easy to throw up a simple plot using the stateful Matlab-style interface:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>xs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(xs, np<span style=color:#f92672>.</span>sin(xs))</span></span></code></pre></div></div><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=matplotlib-sine-wave.png alt=matplotlib-sine-wave.png title=matplotlib-sine-wave.png></p></div><p>However, every plot resides in a figure, which can have a number of subplots. Managing these figures is clunky using the Matlab-style interface. For that reason we'll use the object-oriented interface on explicit references to the figures and axes.</p></div></div><div id=outline-container-headline-8 class=outline-3><h3 id=headline-8>Figures and Axes</h3><div id=outline-text-headline-8 class=outline-text-3><p>Here we make four subplots in a 2x2 layout and put a different kind of plot in each one. Notice 1-based indexing third argument – top left to bottom right.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>5</span>]: fig <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>figure()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>6</span>]: ax1 <span style=color:#f92672>=</span> fig<span style=color:#f92672>.</span>add_subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>7</span>]: ax2 <span style=color:#f92672>=</span> fig<span style=color:#f92672>.</span>add_subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>9</span>]: ax3 <span style=color:#f92672>=</span> fig<span style=color:#f92672>.</span>add_subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>10</span>]: ax4 <span style=color:#f92672>=</span> fig<span style=color:#f92672>.</span>add_subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>13</span>]: ax1<span style=color:#f92672>.</span>hist(np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randn(<span style=color:#ae81ff>100</span>), bins<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>, color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;k&#39;</span>, alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.3</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>13</span>]: <span style=color:#f92672>...</span> elided <span style=color:#66d9ef>for</span> brevity
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;</span>a list of <span style=color:#ae81ff>20</span> Patch objects<span style=color:#f92672>&gt;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>14</span>]: ax2<span style=color:#f92672>.</span>scatter(np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>30</span>), np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>30</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randn(<span style=color:#ae81ff>30</span>))
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>14</span>]: <span style=color:#f92672>&lt;</span>matplotlib<span style=color:#f92672>.</span>collections<span style=color:#f92672>.</span>PathCollection at <span style=color:#ae81ff>0x11477c1d0</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>15</span>]: ax3<span style=color:#f92672>.</span>plot(np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randn(<span style=color:#ae81ff>50</span>)<span style=color:#f92672>.</span>cumsum(), <span style=color:#e6db74>&#39;k--&#39;</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>15</span>]: [<span style=color:#f92672>&lt;</span>matplotlib<span style=color:#f92672>.</span>lines<span style=color:#f92672>.</span>Line2D at <span style=color:#ae81ff>0x114411fd0</span><span style=color:#f92672>&gt;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>18</span>]: ax4<span style=color:#f92672>.</span>plot(np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randn(<span style=color:#ae81ff>30</span>)<span style=color:#f92672>.</span>cumsum(), <span style=color:#e6db74>&#39;ko-&#39;</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>18</span>]: [<span style=color:#f92672>&lt;</span>matplotlib<span style=color:#f92672>.</span>lines<span style=color:#f92672>.</span>Line2D at <span style=color:#ae81ff>0x1146ce0b8</span><span style=color:#f92672>&gt;</span>]</span></span></code></pre></div></div></div></div><div id=outline-container-headline-9 class=outline-3><h3 id=headline-9>Figures</h3><div id=outline-text-headline-9 class=outline-text-3><p>The commands on the previous slide would produce this:</p><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=matplotlib-fig1.png alt=matplotlib-fig1.png title=matplotlib-fig1.png></p></div></div></div><div id=outline-container-headline-10 class=outline-3><h3 id=headline-10><code>plt.subplots</code></h3><div id=outline-text-headline-10 class=outline-text-3><p>Matplotlib includes a convenience method for making subplots.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>20</span>]: fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>22</span>]: axes[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randn(<span style=color:#ae81ff>30</span>)<span style=color:#f92672>.</span>cumsum(), <span style=color:#e6db74>&#39;ko-&#39;</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>22</span>]: [<span style=color:#f92672>&lt;</span>matplotlib<span style=color:#f92672>.</span>lines<span style=color:#f92672>.</span>Line2D at <span style=color:#ae81ff>0x1204e4470</span><span style=color:#f92672>&gt;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>23</span>]: axes[<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>scatter(np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>30</span>), np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>30</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randn(<span style=color:#ae81ff>30</span>))
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>23</span>]: <span style=color:#f92672>&lt;</span>matplotlib<span style=color:#f92672>.</span>collections<span style=color:#f92672>.</span>PathCollection at <span style=color:#ae81ff>0x1204f8940</span><span style=color:#f92672>&gt;</span></span></span></code></pre></div></div><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=matplotlib-fig2.png alt=matplotlib-fig2.png title=matplotlib-fig2.png></p></div><p>Note the 0-based indexing for <code>axes</code>.</p></div></div><div id=outline-container-headline-11 class=outline-3><h3 id=headline-11>Single Plot Shortcut</h3><div id=outline-text-headline-11 class=outline-text-3><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>35</span>]: xs, ys <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>11</span>), np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>11</span>) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>37</span>]: fig, axis <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>38</span>]: axis<span style=color:#f92672>.</span>plot(xs, ys, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-&#39;</span>, color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;g&#39;</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>38</span>]: [<span style=color:#f92672>&lt;</span>matplotlib<span style=color:#f92672>.</span>lines<span style=color:#f92672>.</span>Line2D at <span style=color:#ae81ff>0x120c60518</span><span style=color:#f92672>&gt;</span>]</span></span></code></pre></div></div><ul><li>Notice that if you create a figure with one subplot <code>plt.subplots</code> returns a single axis instead of an array of axes.</li><li>Notice also the explicit linestyle and color.</li></ul><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=matplotlib-fig3.png alt=matplotlib-fig3.png title=matplotlib-fig3.png></p></div><p>This is how I usually do a simple one-plot figure.</p></div></div><div id=outline-container-headline-12 class=outline-3><h3 id=headline-12>Colors, Markers, and Line Styles</h3><div id=outline-text-headline-12 class=outline-text-3><p>Notice the 'ko-' in <code>plot(np.random.randn(30).cumsum(), 'ko-')</code></p><ul><li><p>'k' is a color for the marker and line used in the plot. A few examples:</p><ul><li>'b' - blue</li><li>'g' - green</li><li>'r' - red</li><li>'k' - black</li><li>'w' - white</li></ul></li><li><p>'o' is a marker. A few examples:</p><ul><li>'.' - point marker</li><li>',' - pixel marker</li><li>'o' - circle marker</li><li>'v' - triangle_down marker</li><li>'^' - triangle_up marker</li><li>'&lt;' - triangle_left marker</li><li>'>' - triangle_right marker</li></ul></li><li><p>'-' is a line style. A few examples:</p><ul><li>'-' - solid line style</li><li>'–' - dashed line style</li><li>'-. - dash-dot line style</li><li>':' - dotted line style</li></ul></li></ul><p>For complete details see documentation for <code>plt.plot</code></p></div></div><div id=outline-container-headline-13 class=outline-3><h3 id=headline-13>Legends</h3><div id=outline-text-headline-13 class=outline-text-3><p>A legend is a label for one of the series of data on an axis. Here's an axis with two plots, each having a different label which appears in a legend.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>xs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>plot(xs, np<span style=color:#f92672>.</span>sin(xs), <span style=color:#e6db74>&#34;-g&#34;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sin(x)&#34;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>plot(xs, np<span style=color:#f92672>.</span>cos(xs), <span style=color:#e6db74>&#34;:b&#34;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cos(x)&#34;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>legend() <span style=color:#75715e># Causes the legend to be displayed</span>
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Sine and Cosine&#34;</span>)</span></span></code></pre></div></div><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=sin-cos.png alt=sin-cos.png title=sin-cos.png></p></div></div></div><div id=outline-container-headline-14 class=outline-3><h3 id=headline-14>Ticks and Labels</h3><div id=outline-text-headline-14 class=outline-text-3><p>Ticks and labels are set automatically but can be customized.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>plot(xs, np<span style=color:#f92672>.</span>sin(xs), <span style=color:#e6db74>&#34;-r&#34;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_xticklabels([<span style=color:#e6db74>&#34;wake up&#34;</span>, <span style=color:#e6db74>&#34;coffee kicks in&#34;</span>, <span style=color:#e6db74>&#34;afternoon class&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;afternoon espresso&#34;</span>,      <span style=color:#e6db74>&#34;party time!&#34;</span>, <span style=color:#e6db74>&#34;sleepy time&#34;</span>],
</span></span><span style=display:flex><span>                   rotation<span style=color:#f92672>=</span><span style=color:#ae81ff>45</span>, fontsize<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;small&#34;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Student Biorhythm&#34;</span>)</span></span></code></pre></div></div><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=student-biorhythm.png alt=student-biorhythm.png title=student-biorhythm.png></p></div></div></div><div id=outline-container-headline-15 class=outline-3><h3 id=headline-15>SPX Example</h3><div id=outline-text-headline-15 class=outline-text-3><p>To start, download historical S&amp;P 500 index data: <a href=https://raw.githubusercontent.com/datamastery/pydata-book/2nd-edition/examples/spx.csv>spx.csv</a>. <sup class=footnote-reference><a id=footnote-reference-1 href=#footnote-1>1</a></sup></p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>spx <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;spx.csv&#39;</span>, index_col<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, parse_dates<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>plot(spx<span style=color:#f92672>.</span>index, spx[<span style=color:#e6db74>&#39;SPX&#39;</span>])</span></span></code></pre></div></div><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=spx-all.png alt=spx-all.png title=spx-all.png></p></div></div></div><div id=outline-container-headline-16 class=outline-3><h3 id=headline-16>Annotations</h3><div id=outline-text-headline-16 class=outline-text-3><p>Define annotation data (note use of <a href=https://docs.python.org/3/library/collections.html#collections.namedtuple>collections.namedtuple</a>).</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> collections
</span></span><span style=display:flex><span>Annotation <span style=color:#f92672>=</span> collections<span style=color:#f92672>.</span>namedtuple(<span style=color:#e6db74>&#39;Annotation&#39;</span>, [<span style=color:#e6db74>&#39;label&#39;</span>, <span style=color:#e6db74>&#39;date&#39;</span>])
</span></span><span style=display:flex><span>events <span style=color:#f92672>=</span> [Annotation(label<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Peak bull market&#34;</span>, date<span style=color:#f92672>=</span>dt<span style=color:#f92672>.</span>datetime(<span style=color:#ae81ff>2007</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>11</span>)),
</span></span><span style=display:flex><span>          Annotation(label<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Bear Stearns fails&#34;</span>, date<span style=color:#f92672>=</span>dt<span style=color:#f92672>.</span>datetime(<span style=color:#ae81ff>2008</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>12</span>)),
</span></span><span style=display:flex><span>          Annotation(label<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Lehman bankruptcy&#34;</span>, date<span style=color:#f92672>=</span>dt<span style=color:#f92672>.</span>datetime(<span style=color:#ae81ff>2008</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>15</span>))]</span></span></code></pre></div></div><p>Zoom in on period of interest and add annotations. <sup class=footnote-reference><a id=footnote-reference-2 href=#footnote-2>2</a></sup></p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>ax<span style=color:#f92672>.</span>set(xlim<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;1/1/2007&#39;</span>, <span style=color:#e6db74>&#39;1/1/2011&#39;</span>], ylim<span style=color:#f92672>=</span>[<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>1800</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> event <span style=color:#f92672>in</span> events:
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>annotate(event<span style=color:#f92672>.</span>label,
</span></span><span style=display:flex><span>                xy<span style=color:#f92672>=</span>(event<span style=color:#f92672>.</span>date, spx<span style=color:#f92672>.</span>asof(event<span style=color:#f92672>.</span>date) <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>                xytext<span style=color:#f92672>=</span>(event<span style=color:#f92672>.</span>date, spx<span style=color:#f92672>.</span>asof(event<span style=color:#f92672>.</span>date) <span style=color:#f92672>+</span> <span style=color:#ae81ff>200</span>),
</span></span><span style=display:flex><span>                arrowprops<span style=color:#f92672>=</span>dict(facecolor<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;black&#34;</span>,
</span></span><span style=display:flex><span>                                headwidth<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, width<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, headlength<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>                horizontalalignment<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left&#34;</span>, verticalalignment<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;top&#34;</span>)</span></span></code></pre></div></div><ul><li><code>xy</code> is the x, y position of the arrowhead</li><li><code>xytext</code> is the x, y position of the label</li><li><code>arrowprops</code> defines the shape of the arrow and its head. Note that the length is determined by the distance between <code>xy</code> and <code>xytext</code>.</li><li>See <code>matplotlib.text.Text</code> for <code>horizontalalignment</code> and <code>verticalalignment</code></li></ul></div></div><div id=outline-container-headline-17 class=outline-3><h3 id=headline-17>Annotated SPX Plot</h3><div id=outline-text-headline-17 class=outline-text-3><div class=center-block style=text-align:center;margin-left:auto;margin-right:auto><p><img src=spx-annotations.png alt=spx-annotations.png title=spx-annotations.png></p></div></div></div><div id=outline-container-headline-18 class=outline-3><h3 id=headline-18>Saving Plots to Files</h3><div id=outline-text-headline-18 class=outline-text-3><p>Saving figures is usually as easy as</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fig<span style=color:#f92672>.</span>savefig(<span style=color:#e6db74>&#34;figure.png&#34;</span>)</span></span></code></pre></div></div><p>The graphics encoding is inferred by the file extension (after the last "."). You can find the supported file types and associated file name extensions on your system by:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>77</span>]: fig<span style=color:#f92672>.</span>canvas<span style=color:#f92672>.</span>get_supported_filetypes()
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>77</span>]:
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;eps&#39;</span>: <span style=color:#e6db74>&#39;Encapsulated Postscript&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;pdf&#39;</span>: <span style=color:#e6db74>&#39;Portable Document Format&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;pgf&#39;</span>: <span style=color:#e6db74>&#39;PGF code for LaTeX&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;png&#39;</span>: <span style=color:#e6db74>&#39;Portable Network Graphics&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;ps&#39;</span>: <span style=color:#e6db74>&#39;Postscript&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;raw&#39;</span>: <span style=color:#e6db74>&#39;Raw RGBA bitmap&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;rgba&#39;</span>: <span style=color:#e6db74>&#39;Raw RGBA bitmap&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;svg&#39;</span>: <span style=color:#e6db74>&#39;Scalable Vector Graphics&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;svgz&#39;</span>: <span style=color:#e6db74>&#39;Scalable Vector Graphics&#39;</span>}</span></span></code></pre></div></div><p>Note that there's no need to show the figure before saving it.</p></div></div></div></div><div class=footnotes><hr class=footnotes-separatator><div class=footnote-definitions><div class=footnote-definition><sup id=footnote-1><a href=#footnote-reference-1>1</a></sup><div class=footnote-body><p>Example and data courtesy of Wes McKinney <a href=https://github.com/wesm/pydata-book>https://github.com/wesm/pydata-book</a></p></div></div><div class=footnote-definition><sup id=footnote-2><a href=#footnote-reference-2>2</a></sup><div class=footnote-body><p>See docs for <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.asof.html?highlight=asof#pandas.DataFrame.asof">pandas.DataFrame.asof</a></p></div></div></div></div></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>