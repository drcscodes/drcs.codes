<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes Pandas</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/data-manipulation>Pandas</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Pandas</h2><div id=outline-text-headline-1 class=outline-text-2><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2>Pandas</h3><div id=outline-text-headline-2 class=outline-text-3><ul><li>Built on NumPy</li><li>Adds data structures and data manipulation tools</li><li>Enables easier data cleaning and analysis</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#34;display.width&#34;</span>, <span style=color:#ae81ff>120</span>)</span></span></code></pre></div></div><p>That last line allows you to display DataFrames with many columns without wrapping.</p></div></div><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3>Pandas Fundamentals</h3><div id=outline-text-headline-3 class=outline-text-3><p>Three fundamental Pandas data structures:</p><ul><li><code>Series</code> - a one-dimensional array of values indexed by a <code>pd.Index</code></li><li><code>Index</code> - an array-like object used to access elements of a <code>Series</code> or <code>DataFrame</code></li><li><code>DataFrame</code> - a two-dimensional array with flexible row indices and column names</li></ul></div></div><div id=outline-container-headline-4 class=outline-3><h3 id=headline-4>Series from List</h3><div id=outline-text-headline-4 class=outline-text-3><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>4</span>]: data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Series([<span style=color:#e6db74>&#39;a&#39;</span>,<span style=color:#e6db74>&#39;b&#39;</span>,<span style=color:#e6db74>&#39;c&#39;</span>,<span style=color:#e6db74>&#39;d&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>5</span>]: data
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>5</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>    a
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>    b
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>    c
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>    d
</span></span><span style=display:flex><span>dtype: object</span></span></code></pre></div></div><p>The 0..3 in the left column are the <code>pd.Index</code> for <code>data</code>:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>7</span>]: data<span style=color:#f92672>.</span>index
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>7</span>]: RangeIndex(start<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, stop<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, step<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)</span></span></code></pre></div></div><p>The elements from the Python list we passed to the <code>pd.Series</code> constructor make up the values:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>8</span>]: data<span style=color:#f92672>.</span>values
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>8</span>]: array([<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;d&#39;</span>], dtype<span style=color:#f92672>=</span>object)</span></span></code></pre></div></div><p>Notice that the values are stored in a Numpy array.</p></div></div><div id=outline-container-headline-5 class=outline-3><h3 id=headline-5>Series from Sequence</h3><div id=outline-text-headline-5 class=outline-text-3><p>You can construct a list from any definite sequence:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>24</span>]: pd<span style=color:#f92672>.</span>Series(np<span style=color:#f92672>.</span>loadtxt(<span style=color:#e6db74>&#39;exam1grades.txt&#39;</span>))
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>24</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>72.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>72.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>50.0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>134</span>     <span style=color:#ae81ff>87.0</span>
</span></span><span style=display:flex><span>dtype: float64</span></span></code></pre></div></div><p>or</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>25</span>]: pd<span style=color:#f92672>.</span>Series(open(<span style=color:#e6db74>&#39;exam1grades.txt&#39;</span>)<span style=color:#f92672>.</span>readlines())
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>25</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>72</span>\n
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>72</span>\n
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>50</span>\n
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>134</span>     <span style=color:#ae81ff>87</span>\n
</span></span><span style=display:flex><span>dtype: object</span></span></code></pre></div></div><p>â€¦ but not an indefinite sequence:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>26</span>]: pd<span style=color:#f92672>.</span>Series(open(<span style=color:#e6db74>&#39;exam1grades.txt&#39;</span>))
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TypeError</span>: object of type <span style=color:#e6db74>&#39;_io.TextIOWrapper&#39;</span> has no len()</span></span></code></pre></div></div></div></div><div id=outline-container-headline-6 class=outline-3><h3 id=headline-6>Series from Dictionary</h3><div id=outline-text-headline-6 class=outline-text-3><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>salary <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;Data Scientist&#34;</span>: <span style=color:#ae81ff>110000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;DevOps Engineer&#34;</span>: <span style=color:#ae81ff>110000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Data Engineer&#34;</span>: <span style=color:#ae81ff>106000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Analytics Manager&#34;</span>: <span style=color:#ae81ff>112000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Database Administrator&#34;</span>: <span style=color:#ae81ff>93000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Software Architect&#34;</span>: <span style=color:#ae81ff>125000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Software Engineer&#34;</span>: <span style=color:#ae81ff>101000</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Supply Chain Manager&#34;</span>: <span style=color:#ae81ff>100000</span>}</span></span></code></pre></div></div><p>Create a <code>pd.Series</code> from a <code>dict</code>: <sup class=footnote-reference><a id=footnote-reference-1 href=#footnote-1>1</a></sup></p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>14</span>]: salary_data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Series(salary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>15</span>]: salary_data
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>15</span>]:
</span></span><span style=display:flex><span>Analytics Manager         <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer             <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist            <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Database Administrator     <span style=color:#ae81ff>93000</span>
</span></span><span style=display:flex><span>DevOps Engineer           <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Software Architect        <span style=color:#ae81ff>125000</span>
</span></span><span style=display:flex><span>Software Engineer         <span style=color:#ae81ff>101000</span>
</span></span><span style=display:flex><span>Supply Chain Manager      <span style=color:#ae81ff>100000</span>
</span></span><span style=display:flex><span>dtype: int64</span></span></code></pre></div></div><p>The index is a sorted sequence of the keys of the dictionary passed to <code>pd.Series</code></p></div></div><div id=outline-container-headline-7 class=outline-3><h3 id=headline-7>Series with Custom Index</h3><div id=outline-text-headline-7 class=outline-text-3><p>General form of Series constructor is <code>pd.Series(data, index=index)</code></p><ul><li>Default is integer sequence for sequence data and sorted keys of dictionaries</li><li>Can provide a custom index:</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>29</span>]: pd<span style=color:#f92672>.</span>Series([<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>], index<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;c&#39;</span>])
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>29</span>]:
</span></span><span style=display:flex><span>a    <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>b    <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>c    <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>dtype: int64</span></span></code></pre></div></div><p>The index object itself is an immutable array with set operations.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>30</span>]: i1 <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Index([<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>31</span>]: i2 <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Index([<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>6</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>32</span>]: i1[<span style=color:#ae81ff>1</span>:<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>32</span>]: Int64Index([<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>], dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;int64&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>33</span>]: i1 <span style=color:#f92672>&amp;</span> i2 <span style=color:#75715e># intersection</span>
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>33</span>]: Int64Index([<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>], dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;int64&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>34</span>]: i1 <span style=color:#f92672>|</span> i2 <span style=color:#75715e># union</span>
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>34</span>]: Int64Index([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>], dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;int64&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>35</span>]: i1 <span style=color:#f92672>^</span> i2 <span style=color:#75715e># symmetric difference</span>
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>35</span>]: Int64Index([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>], dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;int64&#39;</span>)</span></span></code></pre></div></div></div></div><div id=outline-container-headline-8 class=outline-3><h3 id=headline-8>Series Indexing and Slicing</h3><div id=outline-text-headline-8 class=outline-text-3><p>Indexing feels like dictionary access due to flexible index objects:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>37</span>]: data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Series([<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;d&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>38</span>]: data[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>38</span>]: <span style=color:#e6db74>&#39;a&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>39</span>]: salary_data[<span style=color:#e6db74>&#39;Software Engineer&#39;</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>39</span>]: <span style=color:#ae81ff>101000</span></span></span></code></pre></div></div><p>But you can also slice using these flexible indices:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>40</span>]: salary_data[<span style=color:#e6db74>&#39;Data Scientist&#39;</span>:<span style=color:#e6db74>&#39;Software Engineer&#39;</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>40</span>]:
</span></span><span style=display:flex><span>Data Scientist            <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Database Administrator     <span style=color:#ae81ff>93000</span>
</span></span><span style=display:flex><span>DevOps Engineer           <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Software Architect        <span style=color:#ae81ff>125000</span>
</span></span><span style=display:flex><span>Software Engineer         <span style=color:#ae81ff>101000</span>
</span></span><span style=display:flex><span>dtype: int64</span></span></code></pre></div></div></div></div><div id=outline-container-headline-9 class=outline-3><h3 id=headline-9>Basic DataFrame Structure</h3><div id=outline-text-headline-9 class=outline-text-3><p>A DataFrame is a series Serieses with the same keys. For example, consider the following dictionary of dictionaries meant to leverage your experience with spreadsheets (in <a href=http://datamastery.github.io/code/analytics/spreadsheet.py>spreadsheet.py</a>):</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>5</span>]: <span style=color:#f92672>import</span> spreadsheet; spreadsheet<span style=color:#f92672>.</span>cells
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>5</span>]:
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;A&#39;</span>: {<span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#39;A1&#39;</span>, <span style=color:#ae81ff>2</span>: <span style=color:#e6db74>&#39;A2&#39;</span>, <span style=color:#ae81ff>3</span>: <span style=color:#e6db74>&#39;A3&#39;</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;B&#39;</span>: {<span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#39;B1&#39;</span>, <span style=color:#ae81ff>2</span>: <span style=color:#e6db74>&#39;B2&#39;</span>, <span style=color:#ae81ff>3</span>: <span style=color:#e6db74>&#39;B3&#39;</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;C&#39;</span>: {<span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#39;C1&#39;</span>, <span style=color:#ae81ff>2</span>: <span style=color:#e6db74>&#39;C2&#39;</span>, <span style=color:#ae81ff>3</span>: <span style=color:#e6db74>&#39;C3&#39;</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;D&#39;</span>: {<span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#39;D1&#39;</span>, <span style=color:#ae81ff>2</span>: <span style=color:#e6db74>&#39;D2&#39;</span>, <span style=color:#ae81ff>3</span>: <span style=color:#e6db74>&#39;D3&#39;</span>}}</span></span></code></pre></div></div><p>All of these dictionaries have the same keys, so we can pass this dictionary of dictionaries to the DataFrame constructor:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>7</span>]: ss <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(spreadsheet<span style=color:#f92672>.</span>cells); ss
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>7</span>]:
</span></span><span style=display:flex><span>    A   B   C   D
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  A1  B1  C1  D1
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  A2  B2  C2  D2
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  A3  B3  C3  D3</span></span></code></pre></div></div><ul><li>Each column is a Series whose keys (index) are the values printed to the left (1, 2 and 3).</li><li>Each row is a Series whose keys (index) are the column headers.</li></ul><p>Try evaluating <code>ss.columns</code> and <code>ss.index</code>.</p></div></div><div id=outline-container-headline-10 class=outline-3><h3 id=headline-10>DataFrame Example</h3><div id=outline-text-headline-10 class=outline-text-3><p>Download <a href=http://datamastery.github.io/code/analytics/hotjobs.py>hotjobs.py</a> and do a <code>%load hotjobs.py</code> (to evaluate the code in the top-level namespace instead of importing it).</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>42</span>]: jobs <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#39;salary&#39;</span>: salary, <span style=color:#e6db74>&#39;openings&#39;</span>: openings})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>43</span>]: jobs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>43</span>]:
</span></span><span style=display:flex><span>                        openings  salary
</span></span><span style=display:flex><span>Analytics Manager           <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer               <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist              <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Database Administrator      <span style=color:#ae81ff>2877</span>   <span style=color:#ae81ff>93000</span>
</span></span><span style=display:flex><span>DevOps Engineer             <span style=color:#ae81ff>2725</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Software Architect          <span style=color:#ae81ff>2232</span>  <span style=color:#ae81ff>125000</span>
</span></span><span style=display:flex><span>Software Engineer          <span style=color:#ae81ff>17085</span>  <span style=color:#ae81ff>101000</span>
</span></span><span style=display:flex><span>Supply Chain Manager        <span style=color:#ae81ff>1270</span>  <span style=color:#ae81ff>100000</span>
</span></span><span style=display:flex><span>UX Designer                 <span style=color:#ae81ff>1691</span>   <span style=color:#ae81ff>92500</span></span></span></code></pre></div></div><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>46</span>]: jobs<span style=color:#f92672>.</span>index
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>46</span>]:
</span></span><span style=display:flex><span>Index([<span style=color:#e6db74>&#39;Analytics Manager&#39;</span>, <span style=color:#e6db74>&#39;Data Engineer&#39;</span>, <span style=color:#e6db74>&#39;Data Scientist&#39;</span>,
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#39;Database Administrator&#39;</span>, <span style=color:#e6db74>&#39;DevOps Engineer&#39;</span>, <span style=color:#e6db74>&#39;Software Architect&#39;</span>,
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#39;Software Engineer&#39;</span>, <span style=color:#e6db74>&#39;Supply Chain Manager&#39;</span>, <span style=color:#e6db74>&#39;UX Designer&#39;</span>],
</span></span><span style=display:flex><span>      dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;object&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>47</span>]: jobs<span style=color:#f92672>.</span>columns
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>47</span>]: Index([<span style=color:#e6db74>&#39;openings&#39;</span>, <span style=color:#e6db74>&#39;salary&#39;</span>], dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;object&#39;</span>)</span></span></code></pre></div></div></div></div><div id=outline-container-headline-11 class=outline-3><h3 id=headline-11>Simple DataFrame Indexing</h3><div id=outline-text-headline-11 class=outline-text-3><p>Simplest indexing of DataFrame is by column name.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>48</span>]: jobs[<span style=color:#e6db74>&#39;salary&#39;</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>48</span>]:
</span></span><span style=display:flex><span>Analytics Manager         <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer             <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist            <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Database Administrator     <span style=color:#ae81ff>93000</span>
</span></span><span style=display:flex><span>DevOps Engineer           <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Software Architect        <span style=color:#ae81ff>125000</span>
</span></span><span style=display:flex><span>Software Engineer         <span style=color:#ae81ff>101000</span>
</span></span><span style=display:flex><span>Supply Chain Manager      <span style=color:#ae81ff>100000</span>
</span></span><span style=display:flex><span>UX Designer                <span style=color:#ae81ff>92500</span>
</span></span><span style=display:flex><span>Name: salary, dtype: int64</span></span></code></pre></div></div><p>Each colum is a Series:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>49</span>]: type(jobs[<span style=color:#e6db74>&#39;salary&#39;</span>])
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>49</span>]: pandas<span style=color:#f92672>.</span>core<span style=color:#f92672>.</span>series<span style=color:#f92672>.</span>Series</span></span></code></pre></div></div></div></div><div id=outline-container-headline-12 class=outline-3><h3 id=headline-12>General Row Indexing</h3><div id=outline-text-headline-12 class=outline-text-3><p>The <code>loc</code> indexer indexes by row name:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>13</span>]: jobs<span style=color:#f92672>.</span>loc[<span style=color:#e6db74>&#39;Software Engineer&#39;</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>13</span>]:
</span></span><span style=display:flex><span>openings     <span style=color:#ae81ff>17085</span>
</span></span><span style=display:flex><span>salary      <span style=color:#ae81ff>101000</span>
</span></span><span style=display:flex><span>Name: Software Engineer, dtype: int64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>14</span>]: jobs<span style=color:#f92672>.</span>loc[<span style=color:#e6db74>&#39;Data Engineer&#39;</span>:<span style=color:#e6db74>&#39;Databse Administrator&#39;</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>14</span>]:
</span></span><span style=display:flex><span>                        openings  salary
</span></span><span style=display:flex><span>Data Engineer               <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist              <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Database Administrator      <span style=color:#ae81ff>2877</span>   <span style=color:#ae81ff>93000</span></span></span></code></pre></div></div><p>Note that slice ending is inclusive when indexing by name.</p><p>The <code>iloc</code> indexer indexes rows by position:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>15</span>]: jobs<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>1</span>:<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>15</span>]:
</span></span><span style=display:flex><span>                openings  salary
</span></span><span style=display:flex><span>Data Engineer       <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist      <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span></span></span></code></pre></div></div><p>Note that slice ending is exclusive when indexing by integer position.</p></div></div><div id=outline-container-headline-13 class=outline-3><h3 id=headline-13>Special Case Row Indexing</h3><div id=outline-text-headline-13 class=outline-text-3><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>16</span>]: jobs[:<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>16</span>]:
</span></span><span style=display:flex><span>                   openings  salary
</span></span><span style=display:flex><span>Analytics Manager      <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer          <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>17</span>]: jobs[jobs[<span style=color:#e6db74>&#39;salary&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100000</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>17</span>]:
</span></span><span style=display:flex><span>                    openings  salary
</span></span><span style=display:flex><span>Analytics Manager       <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer           <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist          <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>DevOps Engineer         <span style=color:#ae81ff>2725</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Software Architect      <span style=color:#ae81ff>2232</span>  <span style=color:#ae81ff>125000</span>
</span></span><span style=display:flex><span>Software Engineer      <span style=color:#ae81ff>17085</span>  <span style=color:#ae81ff>101000</span></span></span></code></pre></div></div><p>These are shortcuts for <code>loc</code> and <code>iloc</code> indexing:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>20</span>]: jobs<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>20</span>]:
</span></span><span style=display:flex><span>                   openings  salary
</span></span><span style=display:flex><span>Analytics Manager      <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer          <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>21</span>]: jobs<span style=color:#f92672>.</span>loc[jobs[<span style=color:#e6db74>&#39;salary&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100000</span>]
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>21</span>]:
</span></span><span style=display:flex><span>                    openings  salary
</span></span><span style=display:flex><span>Analytics Manager       <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>
</span></span><span style=display:flex><span>Data Engineer           <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>
</span></span><span style=display:flex><span>Data Scientist          <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>DevOps Engineer         <span style=color:#ae81ff>2725</span>  <span style=color:#ae81ff>110000</span>
</span></span><span style=display:flex><span>Software Architect      <span style=color:#ae81ff>2232</span>  <span style=color:#ae81ff>125000</span>
</span></span><span style=display:flex><span>Software Engineer      <span style=color:#ae81ff>17085</span>  <span style=color:#ae81ff>101000</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-14 class=outline-3><h3 id=headline-14>Aggregate Functions</h3><div id=outline-text-headline-14 class=outline-text-3><p>The values in a series is a <code>numpy.ndarray</code>, so you can use NumPy functions, broadcasting, etc.</p><ul><li>Average salary for all these jobs:</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>14</span>]: np<span style=color:#f92672>.</span>average(jobs[<span style=color:#e6db74>&#39;salary&#39;</span>])
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>14</span>]: <span style=color:#ae81ff>107125.0</span></span></span></code></pre></div></div><ul><li>Total number of openings:</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>15</span>]: np<span style=color:#f92672>.</span>sum(jobs[<span style=color:#e6db74>&#39;openings&#39;</span>])
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>15</span>]: <span style=color:#ae81ff>34930</span></span></span></code></pre></div></div><p>And so on.</p></div></div><div id=outline-container-headline-15 class=outline-3><h3 id=headline-15>Adding Columns</h3><div id=outline-text-headline-15 class=outline-text-3><p>Add column by broadcasting a constant value:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>16</span>]: jobs[<span style=color:#e6db74>&#39;DM Prepares&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>17</span>]: jobs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>17</span>]:
</span></span><span style=display:flex><span>                        openings  salary  DM Prepares
</span></span><span style=display:flex><span>Analytics Manager           <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>Data Engineer               <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>Data Scientist              <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>Database Administrator      <span style=color:#ae81ff>2877</span>   <span style=color:#ae81ff>93000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>DevOps Engineer             <span style=color:#ae81ff>2725</span>  <span style=color:#ae81ff>110000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>Software Architect          <span style=color:#ae81ff>2232</span>  <span style=color:#ae81ff>125000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>Software Engineer          <span style=color:#ae81ff>17085</span>  <span style=color:#ae81ff>101000</span>         <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>Supply Chain Manager        <span style=color:#ae81ff>1270</span>  <span style=color:#ae81ff>100000</span>         <span style=color:#66d9ef>True</span></span></span></code></pre></div></div><p>Add column by computing value based on row's data:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>25</span>]: jobs[<span style=color:#e6db74>&#39;Percent Openings&#39;</span>] <span style=color:#f92672>=</span> jobs[<span style=color:#e6db74>&#39;openings&#39;</span>] <span style=color:#f92672>/</span> np<span style=color:#f92672>.</span>sum(jobs[<span style=color:#e6db74>&#39;openings&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>26</span>]: jobs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>26</span>]:
</span></span><span style=display:flex><span>                        openings  salary  DM Prepares  Percent Openings
</span></span><span style=display:flex><span>Analytics Manager           <span style=color:#ae81ff>1958</span>  <span style=color:#ae81ff>112000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.056055</span>
</span></span><span style=display:flex><span>Data Engineer               <span style=color:#ae81ff>2599</span>  <span style=color:#ae81ff>106000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.074406</span>
</span></span><span style=display:flex><span>Data Scientist              <span style=color:#ae81ff>4184</span>  <span style=color:#ae81ff>110000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.119782</span>
</span></span><span style=display:flex><span>Database Administrator      <span style=color:#ae81ff>2877</span>   <span style=color:#ae81ff>93000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.082365</span>
</span></span><span style=display:flex><span>DevOps Engineer             <span style=color:#ae81ff>2725</span>  <span style=color:#ae81ff>110000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.078013</span>
</span></span><span style=display:flex><span>Software Architect          <span style=color:#ae81ff>2232</span>  <span style=color:#ae81ff>125000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.063899</span>
</span></span><span style=display:flex><span>Software Engineer          <span style=color:#ae81ff>17085</span>  <span style=color:#ae81ff>101000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.489121</span>
</span></span><span style=display:flex><span>Supply Chain Manager        <span style=color:#ae81ff>1270</span>  <span style=color:#ae81ff>100000</span>         <span style=color:#66d9ef>True</span>          <span style=color:#ae81ff>0.036358</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-16 class=outline-3><h3 id=headline-16>CSV Files</h3><div id=outline-text-headline-16 class=outline-text-3><p>Pandas has a very powerful CSV reader. Do this in iPython (or <code>help(pd.read_csv)</code> in Python):</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>pd<span style=color:#f92672>.</span>read_csv<span style=color:#960050;background-color:#1e0010>?</span></span></span></code></pre></div></div><p>Now let's read the <a href=http://datamastery.github.io/exercises/super-grades.csv><code>super-grades.csv</code></a> file and re-do <a href=http://datamastery.github.io/exercises/calc-grades.html>Calc Grades</a> exercise using Pandas.</p></div></div><div id=outline-container-headline-17 class=outline-3><h3 id=headline-17>Read a CSV File into a DataFrame</h3><div id=outline-text-headline-17 class=outline-text-3><p><code>super-grades.csv</code> contains:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>Student,Exam <span style=color:#ae81ff>1</span>,Exam <span style=color:#ae81ff>2</span>,Exam <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>Thorny,<span style=color:#ae81ff>100</span>,<span style=color:#ae81ff>90</span>,<span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>Mac,<span style=color:#ae81ff>88</span>,<span style=color:#ae81ff>99</span>,<span style=color:#ae81ff>111</span>
</span></span><span style=display:flex><span>Farva,<span style=color:#ae81ff>45</span>,<span style=color:#ae81ff>56</span>,<span style=color:#ae81ff>67</span>
</span></span><span style=display:flex><span>Rabbit,<span style=color:#ae81ff>59</span>,<span style=color:#ae81ff>61</span>,<span style=color:#ae81ff>67</span>
</span></span><span style=display:flex><span>Ursula,<span style=color:#ae81ff>73</span>,<span style=color:#ae81ff>79</span>,<span style=color:#ae81ff>83</span>
</span></span><span style=display:flex><span>Foster,<span style=color:#ae81ff>89</span>,<span style=color:#ae81ff>97</span>,<span style=color:#ae81ff>101</span></span></span></code></pre></div></div><p>The first line is a header, which Pandas will infer, and we want to use the first column for index values:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sgs <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;super-grades.csv&#39;</span>, index_col<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)</span></span></code></pre></div></div><p>Now we have the DataFrame we want:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>3</span>]: sgs <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;super-grades.csv&#39;</span>, index_col<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>4</span>]: sgs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>4</span>]:
</span></span><span style=display:flex><span>         Exam <span style=color:#ae81ff>1</span>  Exam <span style=color:#ae81ff>2</span>  Exam <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>Student
</span></span><span style=display:flex><span>Thorny      <span style=color:#ae81ff>100</span>      <span style=color:#ae81ff>90</span>      <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>Mac          <span style=color:#ae81ff>88</span>      <span style=color:#ae81ff>99</span>     <span style=color:#ae81ff>111</span>
</span></span><span style=display:flex><span>Farva        <span style=color:#ae81ff>45</span>      <span style=color:#ae81ff>56</span>      <span style=color:#ae81ff>67</span>
</span></span><span style=display:flex><span>Rabbit       <span style=color:#ae81ff>59</span>      <span style=color:#ae81ff>61</span>      <span style=color:#ae81ff>67</span>
</span></span><span style=display:flex><span>Ursula       <span style=color:#ae81ff>73</span>      <span style=color:#ae81ff>79</span>      <span style=color:#ae81ff>83</span>
</span></span><span style=display:flex><span>Foster       <span style=color:#ae81ff>89</span>      <span style=color:#ae81ff>97</span>     <span style=color:#ae81ff>101</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-18 class=outline-3><h3 id=headline-18>Adding a Calculated Column to a DataFrame</h3><div id=outline-text-headline-18 class=outline-text-3><p>We've seen how to add a column broadcast from a scalar value or a simple calculation from another column. Now let's add a column with the average grades for each student.</p><p>If we apply this to the DataFrame we get a Series with averages. Notice that we're "collapsing" columns (axis=1), that is, calculating values from a row like we did in NumPy:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>33</span>]: sgs<span style=color:#f92672>.</span>apply(course_avg, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>33</span>]:
</span></span><span style=display:flex><span>Student
</span></span><span style=display:flex><span>Thorny    <span style=color:#ae81ff>90.000000</span>
</span></span><span style=display:flex><span>Mac       <span style=color:#ae81ff>99.333333</span>
</span></span><span style=display:flex><span>Farva     <span style=color:#ae81ff>56.000000</span>
</span></span><span style=display:flex><span>Rabbit    <span style=color:#ae81ff>62.333333</span>
</span></span><span style=display:flex><span>Ursula    <span style=color:#ae81ff>78.333333</span>
</span></span><span style=display:flex><span>Foster    <span style=color:#ae81ff>95.666667</span>
</span></span><span style=display:flex><span>dtype: float64</span></span></code></pre></div></div><p>So we just add this series to the DataFrame:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>35</span>]: sgs[<span style=color:#e6db74>&#34;avg&#34;</span>] <span style=color:#f92672>=</span> sgs<span style=color:#f92672>.</span>apply(course_avg, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>); sgs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>35</span>]:
</span></span><span style=display:flex><span>         Exam <span style=color:#ae81ff>1</span>  Exam <span style=color:#ae81ff>2</span>  Exam <span style=color:#ae81ff>3</span>        avg
</span></span><span style=display:flex><span>Student
</span></span><span style=display:flex><span>Thorny      <span style=color:#ae81ff>100</span>      <span style=color:#ae81ff>90</span>      <span style=color:#ae81ff>80</span>  <span style=color:#ae81ff>90.000000</span>
</span></span><span style=display:flex><span>Mac          <span style=color:#ae81ff>88</span>      <span style=color:#ae81ff>99</span>     <span style=color:#ae81ff>111</span>  <span style=color:#ae81ff>99.333333</span>
</span></span><span style=display:flex><span>Farva        <span style=color:#ae81ff>45</span>      <span style=color:#ae81ff>56</span>      <span style=color:#ae81ff>67</span>  <span style=color:#ae81ff>56.000000</span>
</span></span><span style=display:flex><span>Rabbit       <span style=color:#ae81ff>59</span>      <span style=color:#ae81ff>61</span>      <span style=color:#ae81ff>67</span>  <span style=color:#ae81ff>62.333333</span>
</span></span><span style=display:flex><span>Ursula       <span style=color:#ae81ff>73</span>      <span style=color:#ae81ff>79</span>      <span style=color:#ae81ff>83</span>  <span style=color:#ae81ff>78.333333</span>
</span></span><span style=display:flex><span>Foster       <span style=color:#ae81ff>89</span>      <span style=color:#ae81ff>97</span>     <span style=color:#ae81ff>101</span>  <span style=color:#ae81ff>95.666667</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-19 class=outline-3><h3 id=headline-19>Appending DataFrames</h3><div id=outline-text-headline-19 class=outline-text-3><p>Now let's add a new row containing the averages for each exam.</p><ul><li>We can get the item averages by applying <code>np.mean</code> to the columns (axis=0 â€“ "collapsing" rows):</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>35</span>]: sgs<span style=color:#f92672>.</span>apply(np<span style=color:#f92672>.</span>mean, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>35</span>]:
</span></span><span style=display:flex><span>Exam <span style=color:#ae81ff>1</span>    <span style=color:#ae81ff>75.666667</span>
</span></span><span style=display:flex><span>Exam <span style=color:#ae81ff>2</span>    <span style=color:#ae81ff>80.333333</span>
</span></span><span style=display:flex><span>Exam <span style=color:#ae81ff>3</span>    <span style=color:#ae81ff>84.833333</span>
</span></span><span style=display:flex><span>avg       <span style=color:#ae81ff>80.277778</span>
</span></span><span style=display:flex><span>dtype: float64</span></span></code></pre></div></div><ul><li>We can turn this Series into a DaraFrame with the label we want:</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>38</span>]: pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#34;ItemAverage&#34;</span>: sgs<span style=color:#f92672>.</span>apply(np<span style=color:#f92672>.</span>mean, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)})
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>38</span>]:
</span></span><span style=display:flex><span>        ItemAverage
</span></span><span style=display:flex><span>Exam <span style=color:#ae81ff>1</span>    <span style=color:#ae81ff>75.666667</span>
</span></span><span style=display:flex><span>Exam <span style=color:#ae81ff>2</span>    <span style=color:#ae81ff>80.333333</span>
</span></span><span style=display:flex><span>Exam <span style=color:#ae81ff>3</span>    <span style=color:#ae81ff>84.833333</span>
</span></span><span style=display:flex><span>avg       <span style=color:#ae81ff>80.277778</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-20 class=outline-3><h3 id=headline-20>DataFrame Transpose</h3><div id=outline-text-headline-20 class=outline-text-3><ul><li>But we need to give this DataFrame the same shape as our grades DataFrame:</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>41</span>]: item_avgs <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#34;Item Avg&#34;</span>: sgs<span style=color:#f92672>.</span>apply(np<span style=color:#f92672>.</span>mean, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)})<span style=color:#f92672>.</span>transpose()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>43</span>]: item_avgs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>43</span>]:
</span></span><span style=display:flex><span>             Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>     Exam <span style=color:#ae81ff>3</span>        avg
</span></span><span style=display:flex><span>Item Avg  <span style=color:#ae81ff>75.666667</span>  <span style=color:#ae81ff>80.333333</span>  <span style=color:#ae81ff>84.833333</span>  <span style=color:#ae81ff>80.277778</span></span></span></code></pre></div></div><p>Then we can simply append the DataFrame because it has the same columns:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>24</span>]: sgs <span style=color:#f92672>=</span> sgs<span style=color:#f92672>.</span>append(item_avgs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>25</span>]: sgs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>25</span>]:
</span></span><span style=display:flex><span>              Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>      Exam <span style=color:#ae81ff>3</span>        avg
</span></span><span style=display:flex><span>Thorny    <span style=color:#ae81ff>100.000000</span>  <span style=color:#ae81ff>90.000000</span>   <span style=color:#ae81ff>80.000000</span>  <span style=color:#ae81ff>90.000000</span>
</span></span><span style=display:flex><span>Mac        <span style=color:#ae81ff>88.000000</span>  <span style=color:#ae81ff>99.000000</span>  <span style=color:#ae81ff>111.000000</span>  <span style=color:#ae81ff>99.333333</span>
</span></span><span style=display:flex><span>Farva      <span style=color:#ae81ff>45.000000</span>  <span style=color:#ae81ff>56.000000</span>   <span style=color:#ae81ff>67.000000</span>  <span style=color:#ae81ff>56.000000</span>
</span></span><span style=display:flex><span>Rabbit     <span style=color:#ae81ff>59.000000</span>  <span style=color:#ae81ff>61.000000</span>   <span style=color:#ae81ff>67.000000</span>  <span style=color:#ae81ff>62.333333</span>
</span></span><span style=display:flex><span>Ursula     <span style=color:#ae81ff>73.000000</span>  <span style=color:#ae81ff>79.000000</span>   <span style=color:#ae81ff>83.000000</span>  <span style=color:#ae81ff>78.333333</span>
</span></span><span style=display:flex><span>Foster     <span style=color:#ae81ff>89.000000</span>  <span style=color:#ae81ff>97.000000</span>  <span style=color:#ae81ff>101.000000</span>  <span style=color:#ae81ff>95.666667</span>
</span></span><span style=display:flex><span>Item Avg   <span style=color:#ae81ff>75.666667</span>  <span style=color:#ae81ff>80.333333</span>   <span style=color:#ae81ff>84.833333</span>  <span style=color:#ae81ff>80.277778</span></span></span></code></pre></div></div><p>Note that <code>append</code> is non-destructive, so we have to reassign its returned DataFrame to sgs.</p></div></div><div id=outline-container-headline-21 class=outline-3><h3 id=headline-21>Adding a Letter Grades Column</h3><div id=outline-text-headline-21 class=outline-text-3><p>Adding a column with letter grades is easier than adding a column with a more complex calculation.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>40</span>]: sgs[<span style=color:#e6db74>&#39;Grade&#39;</span>] <span style=color:#f92672>=</span> \
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     np<span style=color:#f92672>.</span>where(sgs[<span style=color:#e6db74>&#39;avg&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>90</span>, <span style=color:#e6db74>&#39;A&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:              np<span style=color:#f92672>.</span>where(sgs[<span style=color:#e6db74>&#39;avg&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>80</span>, <span style=color:#e6db74>&#39;B&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:                       np<span style=color:#f92672>.</span>where(sgs[<span style=color:#e6db74>&#39;avg&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>70</span>, <span style=color:#e6db74>&#39;C&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:                                np<span style=color:#f92672>.</span>where(sgs[<span style=color:#e6db74>&#39;avg&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>60</span>, <span style=color:#e6db74>&#39;D&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:                                         <span style=color:#e6db74>&#39;D&#39;</span>))))
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>41</span>]: sgs
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>41</span>]:
</span></span><span style=display:flex><span>              Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>      Exam <span style=color:#ae81ff>3</span>        avg Grade
</span></span><span style=display:flex><span>Thorny    <span style=color:#ae81ff>100.000000</span>  <span style=color:#ae81ff>90.000000</span>   <span style=color:#ae81ff>80.000000</span>  <span style=color:#ae81ff>90.000000</span>     A
</span></span><span style=display:flex><span>Mac        <span style=color:#ae81ff>88.000000</span>  <span style=color:#ae81ff>99.000000</span>  <span style=color:#ae81ff>111.000000</span>  <span style=color:#ae81ff>99.333333</span>     A
</span></span><span style=display:flex><span>Farva      <span style=color:#ae81ff>45.000000</span>  <span style=color:#ae81ff>56.000000</span>   <span style=color:#ae81ff>67.000000</span>  <span style=color:#ae81ff>56.000000</span>     D
</span></span><span style=display:flex><span>Rabbit     <span style=color:#ae81ff>59.000000</span>  <span style=color:#ae81ff>61.000000</span>   <span style=color:#ae81ff>67.000000</span>  <span style=color:#ae81ff>62.333333</span>     D
</span></span><span style=display:flex><span>Ursula     <span style=color:#ae81ff>73.000000</span>  <span style=color:#ae81ff>79.000000</span>   <span style=color:#ae81ff>83.000000</span>  <span style=color:#ae81ff>78.333333</span>     C
</span></span><span style=display:flex><span>Foster     <span style=color:#ae81ff>89.000000</span>  <span style=color:#ae81ff>97.000000</span>  <span style=color:#ae81ff>101.000000</span>  <span style=color:#ae81ff>95.666667</span>     A
</span></span><span style=display:flex><span>Item Avg   <span style=color:#ae81ff>75.666667</span>  <span style=color:#ae81ff>80.333333</span>   <span style=color:#ae81ff>84.833333</span>  <span style=color:#ae81ff>80.277778</span>     B</span></span></code></pre></div></div></div></div><div id=outline-container-headline-22 class=outline-3><h3 id=headline-22>Grouping and Aggregation</h3><div id=outline-text-headline-22 class=outline-text-3><p>Grouping and aggregation can be conceptualized as a <strong>split, apply, combine</strong> pipeline.</p><ul><li>Split by Grade</li></ul><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>              Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>      Exam <span style=color:#ae81ff>3</span>        avg Grade
</span></span><span style=display:flex><span>Thorny    <span style=color:#ae81ff>100.000000</span>  <span style=color:#ae81ff>90.000000</span>   <span style=color:#ae81ff>80.000000</span>  <span style=color:#ae81ff>90.000000</span>     A
</span></span><span style=display:flex><span>Mac        <span style=color:#ae81ff>88.000000</span>  <span style=color:#ae81ff>99.000000</span>  <span style=color:#ae81ff>111.000000</span>  <span style=color:#ae81ff>99.333333</span>     A
</span></span><span style=display:flex><span>Foster     <span style=color:#ae81ff>89.000000</span>  <span style=color:#ae81ff>97.000000</span>  <span style=color:#ae81ff>101.000000</span>  <span style=color:#ae81ff>95.666667</span>     A</span></span></code></pre></div></div><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>              Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>      Exam <span style=color:#ae81ff>3</span>        avg Grade
</span></span><span style=display:flex><span>Item Avg   <span style=color:#ae81ff>75.666667</span>  <span style=color:#ae81ff>80.333333</span>   <span style=color:#ae81ff>84.833333</span>  <span style=color:#ae81ff>80.277778</span>     B</span></span></code></pre></div></div><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>              Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>      Exam <span style=color:#ae81ff>3</span>        avg Grade
</span></span><span style=display:flex><span>Ursula     <span style=color:#ae81ff>73.000000</span>  <span style=color:#ae81ff>79.000000</span>   <span style=color:#ae81ff>83.000000</span>  <span style=color:#ae81ff>78.333333</span>     C</span></span></code></pre></div></div><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>              Exam <span style=color:#ae81ff>1</span>     Exam <span style=color:#ae81ff>2</span>      Exam <span style=color:#ae81ff>3</span>        avg Grade
</span></span><span style=display:flex><span>Farva      <span style=color:#ae81ff>45.000000</span>  <span style=color:#ae81ff>56.000000</span>   <span style=color:#ae81ff>67.000000</span>  <span style=color:#ae81ff>56.000000</span>     D
</span></span><span style=display:flex><span>Rabbit     <span style=color:#ae81ff>59.000000</span>  <span style=color:#ae81ff>61.000000</span>   <span style=color:#ae81ff>67.000000</span>  <span style=color:#ae81ff>62.333333</span>     D</span></span></code></pre></div></div><ul><li>Apply some aggregation function to each group, such as sum, mean, count.</li><li>Combine results of function applications to get final results for each group.</li></ul></div></div><div id=outline-container-headline-23 class=outline-3><h3 id=headline-23>Letter Grades Counts</h3><div id=outline-text-headline-23 class=outline-text-3><p>Here's how to find the counts of letter grades for our super troopers:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>58</span>]: sgs[<span style=color:#e6db74>&#39;Grade&#39;</span>]<span style=color:#f92672>.</span>groupby(sgs[<span style=color:#e6db74>&#39;Grade&#39;</span>])<span style=color:#f92672>.</span>count()
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>58</span>]:
</span></span><span style=display:flex><span>Grade
</span></span><span style=display:flex><span>A    <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>B    <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>C    <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>D    <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>Name: Grade, dtype: int64</span></span></code></pre></div></div></div></div><div id=outline-container-headline-24 class=outline-3><h3 id=headline-24>Messy CSV Files</h3><div id=outline-text-headline-24 class=outline-text-3><p>Remember the <a href=../exercises/tides.html>Tides Exercise</a>? Pandas's <code>read_csv</code> can handle most of the data pre-processing:</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;wpb-tides-2017.txt&#39;</span>, sep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#39;</span>, skiprows<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>, header<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>            usecols<span style=color:#f92672>=</span>[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>7</span>],
</span></span><span style=display:flex><span>            names<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Day&#39;</span>, <span style=color:#e6db74>&#39;Time&#39;</span>, <span style=color:#e6db74>&#39;Pred(ft)&#39;</span>, <span style=color:#e6db74>&#39;Pred(cm)&#39;</span>, <span style=color:#e6db74>&#39;High/Low&#39;</span>],
</span></span><span style=display:flex><span>            parse_dates<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Date&#39;</span>,<span style=color:#e6db74>&#39;Time&#39;</span>])</span></span></code></pre></div></div><p>Let's use the indexing and data selection techniques we've learned to re-do the <a href=../exercises/tides.html>Tides Exercise</a> as a Jupyter Notebook. For convenience, <code>wpb-tides-2017.txt</code> is in the <a href=https://github.com/cs2316/cs2316.github.io/tree/master/code/analytics>code/analytics</a> directory, or you can <a href=../code/analytics/wpb-tides-2017.txt>download it</a>.</p></div></div><div id=outline-container-headline-25 class=outline-3><h3 id=headline-25>Reading SQL Databases</h3><div id=outline-text-headline-25 class=outline-text-3><p>Let's create a realistically sized grades example dataset using fake student names. We'll get the names from the <a href=https://dev.mysql.com/doc/sakila/en/>Sakila Sample Database</a>.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>  <span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>  <span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>  <span style=color:#f92672>import</span> pymysql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  sakila <span style=color:#f92672>=</span> pymysql<span style=color:#f92672>.</span>connect(host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;localhost&#34;</span>,
</span></span><span style=display:flex><span>                           user<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;root&#34;</span>,
</span></span><span style=display:flex><span>                           password<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>                           db<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sakila&#34;</span>,
</span></span><span style=display:flex><span>                           charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf8mb4&#34;</span>,
</span></span><span style=display:flex><span>                           cursorclass<span style=color:#f92672>=</span>pymysql<span style=color:#f92672>.</span>cursors<span style=color:#f92672>.</span>DictCursor)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  names <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_sql(<span style=color:#e6db74>&#34;select first_name, last_name from actor&#34;</span>, con <span style=color:#f92672>=</span> sakila)
</span></span><span style=display:flex><span>  names<span style=color:#f92672>.</span>head()</span></span></code></pre></div></div><div class="src src-python"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    first_name     last_name
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>0</span>   PENELOPE       GUINESS
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span>       NICK      WAHLBERG
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2</span>         ED         CHASE
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>3</span>   JENNIFER         DAVIS
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>4</span>     JOHNNY  LOLLOBRIGIDA</span></span></code></pre></div></div></div></div><div id=outline-container-headline-26 class=outline-3><h3 id=headline-26>Creating Datasets</h3><div id=outline-text-headline-26 class=outline-text-3><p>Look at the <a href=https://github.com/datamastery/datamastery.github.io/blob/master/code/analytics/sakila-grades.ipynb>sakil-grades.ipynb</a> notebook for an example of extracting data from a database and creating a realistically sized fake data set similar to the grades file downladed from Canvas.</p><p>There's also an <a href=https://orgmode.org/>org-mode</a> version for Emacs users: <a href=https://github.com/datamastery/datamastery.github.io/blob/master/code/analytics/sakila-grades.org>sakila-grades.org</a></p></div></div></div></div><div class=footnotes><hr class=footnotes-separatator><div class=footnote-definitions><div class=footnote-definition><sup id=footnote-1><a href=#footnote-reference-1>1</a></sup><div class=footnote-body><p><a href=https://www.glassdoor.com/List/Best-Jobs-in-America-LST_KQ0,20.htm><a href=https://www.glassdoor.com/List/Best-Jobs-in-America-LST_KQ0,20.htm>https://www.glassdoor.com/List/Best-Jobs-in-America-LST_KQ0,20.htm</a></a></p></div></div></div></div></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>