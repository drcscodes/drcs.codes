<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/machine-learning></a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><p>% Introduction to Spark</p><h2 id=apache-spark>Apache Spark</h2><p>&ldquo;Unified computing engine&rdquo;</p><ul><li>cluster manager for running programs distributed across multiple computers (&ldquo;nodes&rdquo;)<ul><li>Spark cluster manager, YARN, or Mesos</li></ul></li><li>libraries for parallel data processing</li></ul><h2 id=spark-applications>Spark Applications</h2><ul><li>Driver process runs <code>main()</code> function on a node in the cluster<ul><li>Maintains information about the Spark application</li><li>Responds to user&rsquo;s program or input</li><li>Analyzes, distributes, and schedules work across executors</li></ul></li><li>Executor processes<ul><li>Carry out work assigned by driver</li><li>Report state of computation to driver</li></ul></li></ul><p><img src=spark-app-architecture.png alt="Spark Application Architecture">{height=30%}</p><h2 id=spark-langauges-and-apis>Spark Langauges and APIs</h2><p>Executors run Spark code. Driver runs user&rsquo;s program, which can be written in one of Spark&rsquo;s langauge APIs:</p><ul><li>Scala &ndash; the default language; Spark is written in Scala.</li><li>Java</li><li>Python &ndash; includes most of the Scala API</li><li>SQL &ndash; subset of ANSI SQL 2003</li><li>R &ndash; SparkR is part of Spark core, R community provides an alternative called spraklyr</li></ul><p><img src=spark-session-lang-apis.png alt="Spark Session and Language APIs">{height=20%}</p><p>Note: there are two APIs: a high-level &ldquo;structured&rdquo; API, and a low-level API.</p><h2 id=spark-session>Spark Session</h2><p>Every Spark application has exactly one associated <code>SparkSession</code>.</p><ul><li>Explicitly create a <code>SparkSession</code> in Spark programs</li><li><code>SparkSession</code> instance implicitly created in Spark shell</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Scala data-lang=Scala><span style=display:flex><span>scala<span style=color:#f92672>&gt;</span> spark
</span></span><span style=display:flex><span>res0<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>org.apache.spark.sql.SparkSession</span> <span style=color:#f92672>=</span> org<span style=color:#f92672>.</span>apache<span style=color:#f92672>.</span>spark<span style=color:#f92672>.</span>sql<span style=color:#f92672>.</span><span style=color:#a6e22e>SparkSession</span><span style=color:#66d9ef>@</span><span style=color:#ae81ff>32950</span>acc
</span></span></code></pre></div><h2 id=dataframes>DataFrames</h2><p>A DataFrame is table of rows and columns partitioned across the nodes in the Spark cluster.</p><p><img src=dataframe-vs-spreadsheet.png alt></p><h2 id=dataframe>DataFrame</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Scala data-lang=Scala><span style=display:flex><span>scala<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>val</span> myRange <span style=color:#66d9ef>=</span> spark<span style=color:#f92672>.</span>range<span style=color:#f92672>(</span><span style=color:#ae81ff>1000</span><span style=color:#f92672>).</span>toDF<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;number&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>myRange<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>org.apache.spark.sql.DataFrame</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#66d9ef>number:</span> <span style=color:#66d9ef>bigint</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>scala<span style=color:#f92672>&gt;</span> myRange<span style=color:#f92672>.</span>show<span style=color:#f92672>(</span><span style=color:#ae81ff>5</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>number<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     <span style=color:#ae81ff>0</span><span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     <span style=color:#ae81ff>1</span><span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     <span style=color:#ae81ff>2</span><span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     <span style=color:#ae81ff>3</span><span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     <span style=color:#ae81ff>4</span><span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+</span>
</span></span><span style=display:flex><span>only showing top <span style=color:#ae81ff>5</span> rows
</span></span></code></pre></div><p>A DataFrame&rsquo;s schema is a list of columns and their types:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Scala data-lang=Scala><span style=display:flex><span>scala<span style=color:#f92672>&gt;</span> myRange<span style=color:#f92672>.</span>schema
</span></span><span style=display:flex><span>res6<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>org.apache.spark.sql.</span><span style=color:#66d9ef>type</span><span style=color:#66d9ef>s.StructType</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>StructType</span><span style=color:#f92672>(</span><span style=color:#a6e22e>StructField</span><span style=color:#f92672>(</span>number<span style=color:#f92672>,</span><span style=color:#a6e22e>LongType</span><span style=color:#f92672>,</span><span style=color:#66d9ef>false</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>scala<span style=color:#f92672>&gt;</span> myRange<span style=color:#f92672>.</span>printSchema
</span></span><span style=display:flex><span>root
</span></span><span style=display:flex><span> <span style=color:#f92672>|--</span> number<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>long</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>nullable</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>A DataFrame is</p><h2 id=dataframe-computation-pipeline>DataFrame Computation Pipeline</h2><ul><li>Transformations take a DataFrame as input and produce another DataFrame (lazily)</li><li>An action is executed as the last step of a computation pipeline to produce the final DataFrame</li></ul></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>