<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes Streams</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/java-oop>Streams</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Streams</h2><div id=outline-text-headline-1 class=outline-text-2><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2>Streams and Pipelines</h3><div id=outline-text-headline-2 class=outline-text-3><p>A stream is a sequence of elements.</p><ul><li>Unlike a collection, it is not a data structure that stores elements.</li><li>Unlike an iterator, streams do not allow modification of the underlying source</li></ul><p>A stream carries values from a source through a pipeline.</p><p>A pipeline contains the following components:</p><ul><li>A <strong>source</strong>: This could be a collection, an array, a generator function, or an I/O channel.</li><li>Zero or more <strong>intermediate operations</strong>. An intermediate operation, such as filter, produces a new stream</li><li>A <strong>terminal operation</strong>. A terminal operation, such as forEach, produces a non-stream result, such as a primitive value (like a double value), a collection, or in the case of forEach, no value at all.</li></ul></div></div><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3>Stream Example: How Many Mustaches?</h3><div id=outline-text-headline-3 class=outline-text-3><p>Consider this simple example from</p><p><a href=../code/collections/super-troopers/SuperTroopers.java>SuperTroopers.java</a>:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>long</span> mustaches <span style=color:#f92672>=</span> troopers<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>Trooper<span style=color:#f92672>::</span>hasMustache<span style=color:#f92672>).</span><span style=color:#a6e22e>count</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Mustaches: &#34;</span> <span style=color:#f92672>+</span> mustaches<span style=color:#f92672>);</span></span></span></code></pre></div></div><ul><li><code>troopers.stream()</code> is the <em>source</em></li><li><code>.filter(Trooper::hasMustache)</code> is an <em>intermediate operation</em></li><li><code>.count()</code> is the <em>terminal operation</em></li></ul><p>The terminal operation yields a new value which results from applying all the intermediate operations and finally the terminal operation to the source.</p><p>Let's look at this simple stream in detail.</p></div></div><div id=outline-container-headline-4 class=outline-3><h3 id=headline-4>Stream.filter</h3><div id=outline-text-headline-4 class=outline-text-3><p>Here's the signature of the <code>filter</code> method in <code>Stream&lt;T></code>:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Stream<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>Predicate<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> predicate<span style=color:#f92672>)</span></span></span></code></pre></div></div><ul><li><code>filter</code> takes a <code>Predicate&lt;? super T> predicate)</code></li></ul><p>Here's <code>Predicate&lt;T></code></p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Predicate</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> Predicate<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>and</span><span style=color:#f92672>(</span>Predicate<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> other<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#f92672>...</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> Predicate<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>isEqual</span><span style=color:#f92672>(</span>Object targetRef<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#f92672>...</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> Predicate<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>negate</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>...</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> Predicate<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>or</span><span style=color:#f92672>(</span>Predicate<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> other<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#f92672>...</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>test</span><span style=color:#f92672>(</span>T t<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></div><p>What is the single abstract method (SAM) in <code>Predicate&lt;T></code>?</p></div></div><div id=outline-container-headline-5 class=outline-3><h3 id=headline-5>A <code>Predicate&lt;T></code> Class</h3><div id=outline-text-headline-5 class=outline-text-3><p>A <code>Predicate&lt;T></code> is an object that has a <code>boolean test(T t)</code> method. Here's a <code>Predicate&lt;T></code> class:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HasMustache</span> <span style=color:#66d9ef>implements</span> Predicate<span style=color:#f92672>&lt;</span>Trooper<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>test</span><span style=color:#f92672>(</span>Trooper t<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>hasMustache</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></div><p>An object of the <code>HasMustache</code> class is a <code>Predicate&lt;T></code>.</p><p>Here's the same <code>Predicate&lt;T></code> class as an anonymous inner class:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>new</span> Predicate<span style=color:#f92672>&lt;</span>Trooper<span style=color:#f92672>&gt;()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>test</span><span style=color:#f92672>(</span>Trooper t<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>hasMustache</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-6 class=outline-3><h3 id=headline-6>A <code>Predicate&lt;T></code> Lambda Expression</h3><div id=outline-text-headline-6 class=outline-text-3><p>Here's the same <code>Predicate&lt;T></code> class as a lambda expression (in the context of the filter method â€“ why is that important?):</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>troopers<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>t <span style=color:#f92672>-&gt;</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>hasMustache</span><span style=color:#f92672>()).</span><span style=color:#a6e22e>count</span><span style=color:#f92672>();</span></span></span></code></pre></div></div><p>Here's the lambda expression above as a method reference:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>troopers<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>Trooper<span style=color:#f92672>::</span>hasMustache<span style=color:#f92672>).</span><span style=color:#a6e22e>count</span><span style=color:#f92672>();</span></span></span></code></pre></div></div><p><code>Trooper::hasMustache</code> supplies the body of the <code>Predicate&lt;T></code> <code>test(T t)</code> method by calling <code>t.hasMustache()</code>.</p><p>Play with <a href=../code/collections/super-troopers/StreamTroopers.java>StreamTroopers.java</a> to see these <code>Predicate&lt;T></code> implementations in action.</p></div></div><div id=outline-container-headline-7 class=outline-3><h3 id=headline-7>A Bigger Stream Example: WordCount Pipeline</h3><div id=outline-text-headline-7 class=outline-text-3><p>Consider this example from <code>WordCount</code>:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Set<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stopWords <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;an&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;and&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;are&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;as&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;be&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;by&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;in&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;of&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;for&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;from&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;not&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;to&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;the&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;that&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;with&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;which&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>wc<span style=color:#f92672>.</span><span style=color:#a6e22e>wordCounts</span><span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>().</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>!</span>stopWords<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toLowerCase</span><span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>sorted</span><span style=color:#f92672>((</span>e1<span style=color:#f92672>,</span> e2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> e1<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> e2<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%s occurs %d times%n&#34;</span><span style=color:#f92672>,</span> entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                                  entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()));</span></span></span></code></pre></div></div><p>This code does the same tasks we did before with classes and for loops.</p></div></div><div id=outline-container-headline-8 class=outline-3><h3 id=headline-8>WordCount Pipeline - Stop Words</h3><div id=outline-text-headline-8 class=outline-text-3><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Set<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stopWords <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;an&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;and&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;are&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;as&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;be&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;by&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;in&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;of&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;for&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;from&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;not&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;to&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;the&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;that&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;with&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;which&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>));</span></span></span></code></pre></div></div><ul><li>Every document has information-carrying words and grammatical words that carry no information, like prepositions, verbs like to be or have, pronouns</li><li>In document processing we call these non-information-carrying words <em>stop words</em></li></ul><p>Here we've implemented a naiive and terribly incomplete stop words list.</p><p>BTW, why a <code>HashSet</code>?</p></div></div><div id=outline-container-headline-9 class=outline-3><h3 id=headline-9>WordCount Pipeline - filter</h3><div id=outline-text-headline-9 class=outline-text-3><p>Consider this example from ~WordCount~s:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Set<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stopWords <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;an&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;and&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;are&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;as&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;be&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;by&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;in&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;of&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;for&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;from&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;not&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;to&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;the&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;that&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;with&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;which&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>wc<span style=color:#f92672>.</span><span style=color:#a6e22e>wordCounts</span><span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>().</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>!</span>stopWords<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toLowerCase</span><span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>sorted</span><span style=color:#f92672>((</span>e1<span style=color:#f92672>,</span> e2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> e1<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> e2<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%s occurs %d times%n&#34;</span><span style=color:#f92672>,</span> entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                                  entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()));</span></span></span></code></pre></div></div><p>The filter operation takes a predicate function.</p><ul><li>A predicate function returns a <code>boolean</code></li><li>If predicate function returns <code>true</code>, element is retained in the stream</li></ul><p>Notice that we're also normalizing words to lower case.</p></div></div><div id=outline-container-headline-10 class=outline-3><h3 id=headline-10>WordCount Pipeline - sorted</h3><div id=outline-text-headline-10 class=outline-text-3><p>Consider this example from ~WordCount~s:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Set<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stopWords <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;an&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;and&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;are&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;as&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;be&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;by&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;in&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;of&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;for&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;from&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;not&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;to&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;the&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;that&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;with&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;which&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>wc<span style=color:#f92672>.</span><span style=color:#a6e22e>wordCounts</span><span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>().</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>!</span>stopWords<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toLowerCase</span><span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>sorted</span><span style=color:#f92672>((</span>e1<span style=color:#f92672>,</span> e2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> e1<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> e2<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%s occurs %d times%n&#34;</span><span style=color:#f92672>,</span> entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                                  entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()));</span></span></span></code></pre></div></div><p>The sortd operation takes a <code>Comparator</code> that defines the ordering over the stream's elements.</p></div></div><div id=outline-container-headline-11 class=outline-3><h3 id=headline-11>WordCount Pipeline - forEach</h3><div id=outline-text-headline-11 class=outline-text-3><p>Consider this example from ~WordCount~s:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Set<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stopWords <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;an&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;and&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;are&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;as&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;be&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;by&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;in&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;of&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;for&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;from&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;not&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;to&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;the&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;that&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;with&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;which&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>wc<span style=color:#f92672>.</span><span style=color:#a6e22e>wordCounts</span><span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>().</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>!</span>stopWords<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toLowerCase</span><span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>sorted</span><span style=color:#f92672>((</span>e1<span style=color:#f92672>,</span> e2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> e1<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> e2<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%s occurs %d times%n&#34;</span><span style=color:#f92672>,</span> entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                                  entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()));</span></span></span></code></pre></div></div><p><code>forach</code> is the terminal operation.</p><ul><li>Called for its effect - no return value</li></ul><p>The underlying source is not modified.</p></div></div><div id=outline-container-headline-12 class=outline-3><h3 id=headline-12>Homework: Make the WordCount Pipeline Clearer</h3><div id=outline-text-headline-12 class=outline-text-3><p>Notice that we use anonymous lambda expressions in our WordCOunt pipeline:</p><div class="src src-java"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>wc<span style=color:#f92672>.</span><span style=color:#a6e22e>wordCounts</span><span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>().</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>!</span>stopWords<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toLowerCase</span><span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>sorted</span><span style=color:#f92672>((</span>e1<span style=color:#f92672>,</span> e2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> e1<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> e2<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>entry <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%s occurs %d times%n&#34;</span><span style=color:#f92672>,</span> entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                                  entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>()));</span></span></span></code></pre></div></div><ul><li>Functional-style code can easily become hard to read.</li><li>You can improve readability by introducing intermediate helper variables with informative names.</li></ul><p>Rewrite the WordCount pipeline with intermediate helper variables so that the pipeline is easy to understand. You'll need to look up these aggregate operations in the Java API to get the types for these variables.</p></div></div></div></div></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>