<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/python></a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Creating Sakila Grades Example</h2><div id=outline-text-headline-1 class=outline-text-2><p>First, preliminary imports:</p><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython>  import numpy as np
  import pandas as pd
  import pymysql</code></pre></div><p>Now get the names from the database.</p><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython>  sakila = pymysql.connect(host=&#34;localhost&#34;,
                           user=&#34;root&#34;,
                           password=&#34;&#34;,
                           db=&#34;sakila&#34;,
                           charset=&#34;utf8mb4&#34;,
                           cursorclass=pymysql.cursors.DictCursor)

  grades = pd.read_sql(&#34;select first_name, last_name from actor&#34;, con = sakila)
  grades.head()</code></pre></div><pre class=example>
  first_name     last_name
  0   PENELOPE       GUINESS
  1       NICK      WAHLBERG
  2         ED         CHASE
  3   JENNIFER         DAVIS
  4     JOHNNY  LOLLOBRIGIDA
</pre><p>Update the index with login ids taht look like GT login IDs, generated from names, e.g.. Penelope Guinness's id is pguiness0.</p><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython>ids = [grades.loc[i][&#39;first_name&#39;].lower()[0] + grades.loc[i][&#39;last_name&#39;].lower() + str(i)
       for i in grades.index]
grades.index = ids
grades.index.name = &#34;loginId&#34;
grades.head()</code></pre></div><pre class=example>
  first_name     last_name
  loginId
  pguiness0        PENELOPE       GUINESS
  nwahlberg1           NICK      WAHLBERG
  echase2                ED         CHASE
  jdavis3          JENNIFER         DAVIS
  jlollobrigida4     JOHNNY  LOLLOBRIGIDA
</pre><p>Convert names to capitalized form.</p><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython>grades[&#39;first_name&#39;] = grades.apply(lambda row: row[&#39;first_name&#39;].capitalize(), axis=1)
grades[&#39;last_name&#39;] = grades.apply(lambda row: row[&#39;last_name&#39;].capitalize(), axis=1)
grades.head()</code></pre></div><pre class=example>
  first_name     last_name
  loginId
  pguiness0        Penelope       Guiness
  nwahlberg1           Nick      Wahlberg
  echase2                Ed         Chase
  jdavis3          Jennifer         Davis
  jlollobrigida4     Johnny  Lollobrigida
</pre><p>Make a single "name" column with last_name, first_name format, get rid of old last_name and first_name columns.</p><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython>grades[&#39;name&#39;] = grades.apply(lambda row: f&#34;{row[&#39;last_name&#39;]}, {row[&#39;first_name&#39;]}&#34;, axis=1)
del(grades[&#39;first_name&#39;])
del(grades[&#39;last_name&#39;])
grades.head()</code></pre></div><pre class=example>
  name
  loginId
  pguiness0          Guiness, Penelope
  nwahlberg1            Wahlberg, Nick
  echase2                    Chase, Ed
  jdavis3              Davis, Jennifer
  jlollobrigida4  Lollobrigida, Johnny
</pre><p>Add some fake assignments and grades.</p><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython>for hw in [&#34;hw0&#34;, &#34;hw1&#34;, &#34;hw3&#34;]:
    grades[hw] = np.random.normal(90, 5, len(grades))
for quiz in [&#34;quiz1&#34;, &#34;quiz2&#34;, &#34;quiz3&#34;, &#34;quiz4&#34;, &#34;quiz5&#34;, &#34;quiz6&#34;]:
    grades[quiz] = np.random.normal(70, 10, len(grades))
for exam in [&#34;exam1&#34;, &#34;exam2&#34;, &#34;exam3&#34;, &#34;final_exam&#34;]:
    grades[exam] = np.random.normal(78, 10, len(grades))
# Convert grades to integers
for col in grades.columns[1:]:
    grades[col] = grades[col].astype(&#39;int&#39;, copy=False)
grades.to_csv(&#34;sakila-grades.csv&#34;)
grades.head()</code></pre></div><pre class=example>
  name  hw0  hw1  hw3  quiz1  quiz2  quiz3  \
  loginId
  pguiness0          Guiness, Penelope   85   99   95     79     69     61
  nwahlberg1            Wahlberg, Nick   95   93   95     73     58     66
  echase2                    Chase, Ed   87   94   90     65     63     62
  jdavis3              Davis, Jennifer   87   87   94     76     66     72
  jlollobrigida4  Lollobrigida, Johnny   95   89   92     68     66     72

  quiz4  quiz5  quiz6  exam1  exam2  exam3  final_exam
  loginId
  pguiness0          77     51     87     92     91     73          73
  nwahlberg1         66     66     75     89     91     87          78
  echase2            67     60     62     73     79     59          60
  jdavis3            54     73     81     82     78     77          75
  jlollobrigida4     68     63     44     70     80     54          50
</pre><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython></code></pre></div><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython></code></pre></div><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython></code></pre></div><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython></code></pre></div><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython></code></pre></div><div class="src src-ipython"><pre tabindex=0><code class=language-ipython data-lang=ipython></code></pre></div></div></div></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>