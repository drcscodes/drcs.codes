<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dr. CS codes Packages and Environments</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://DrCS.codes/css/syntax.css><link rel=stylesheet href=https://DrCS.codes/css/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link href=https://DrCS.codes/css/navbar-top-fixed.css rel=stylesheet></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/professional-python>Packages and Environments</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"></ul><ul class="navbar-nav pull-right"><li class="nav-item pull-right"><a class=nav-link href=https://DrCS.codes>Dr. CS codes</a></li></ul></div></nav><main role=main class=container><h2 id=packages>Packages</h2><p>There are two meanings for &ldquo;package&rdquo; in Python:</p><ol><li>Subdirectories into which modules are organized. See <a href=https://docs.python.org/3/tutorial/modules.html#packages>Python&rsquo;s module documentation</a> for details.</li><li>A distribution of 3rd-party software, e.g., Python modules and supporting files, native code, etc.</li></ol><p>Here we discuss the second meaning.</p><h2 id=installing-packages>Installing Packages</h2><p>The <code>pip3</code> command downloads and installs packages.</p><ul><li>Packages come from the <a href=https://pypi.org/>Python Package Index</a> by default.</li><li><code>pip3</code> is quite flexible, allowing you to install from many kinds of sources. See the <a href=https://packaging.python.org/en/latest/tutorials/installing-packages/>Python package tutorial</a> for details.</li></ul><p>You can invoke <code>pip3</code> in two ways, for example, to install <code>ipython</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python3 -m pip install ipython
</span></span></code></pre></div><p>or</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pip3 install ipython
</span></span></code></pre></div><h2 id=module-search-path>Module Search Path</h2><p>Just as an operating system command shell searches for executable programs by searching the directories listed in the <code>PATH</code> environment variable, Python finds modules by searching directories. The module search path is stored in <code>sys.path</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>from</span> pprint <span style=color:#f92672>import</span> pprint
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> pprint(sys<span style=color:#f92672>.</span>path)
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;/Library/Frameworks/Python.framework/Versions/3.10/lib/python310.zip&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;/Users/drcs/vcs/github.com/drcscodes/python-coursework/venv/lib/python3.10/site-packages&#39;</span>]
</span></span></code></pre></div><ul><li>Notice that the current directory, represented by the <code>''</code> at the beginning of the search path, is part of <code>sys.path</code>, which is why you can import modules located in your current directory.</li><li>Notice that our virtual environment is in the <code>sys.path</code>.</li><li>Note use of <code>pprint</code>, which &ldquo;pretty prints&rdquo; the <code>sys.path</code> list in a more easily readable format.</li></ul><h2 id=virtual-environments>Virtual Environments</h2><p>Different Python projects may use different versions of the same package. To avoid conflicts, use virtual environments.</p><p>In the root directory of your Python project, create your virtual environment with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python3 -m venv venv
</span></span></code></pre></div><p>This creates a virtual environment in the <code>venv</code> subdirectory of your project root directory. Activate the virtual environment on macOS or Linux with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>source venv/bin/activate
</span></span></code></pre></div><p>or in Windows PowerShell (if this doesn&rsquo;t work, try <code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</code>. See <a href=https://docs.python.org/3/library/venv.html>venv docs</a> for details.):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>venv<span style=color:#ae81ff>\b</span>in<span style=color:#ae81ff>\a</span>ctivate.ps1
</span></span></code></pre></div><p>Deactivate a virtual environment with (macOS, Linux, or Windows):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>deactivate
</span></span></code></pre></div><h2 id=active-review>Active Review</h2><ul><li>Create a scratch directory, <code>cd</code> to it, and then create a virtual environment in the <code>test</code> subdirectory.</li><li>Print the contents of <code>sys.path</code>.<ul><li>Tip: you can do that quickly with <code>python3 -c "import sys, pprint as pp; pp.pprint(sys.path)"</code></li></ul></li><li>Activate your new <code>test</code> environment.<ul><li>Note the difference in your OS command shell&rsquo;s prompt string, if any.</li></ul></li><li>Print the contents of <code>sys.path</code> again and note the difference.</li><li>Deactivate your <code>test</code> environment.<ul><li>You can delete the scratch directory.</li></ul></li><li>In your OS command shell, repeat the steps above, except for the first step of creating an environment, for the <code>venv</code> directory created by a PyCharm project.</li><li>In PyCharm with a Python project open, open a terminal and note the automatic loading of its <code>venv</code> environment.</li></ul><h2 id=requirementstxt><code>requirements.txt</code></h2><p>In your Python projects you should include a <code>requirements.txt</code> file in the root directory of your project and add <code>requirements.txt</code> to your project&rsquo;s Git repository. With your virtual environment activated and all required packages installed, create <code>requirements.txt</code> with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python3 -m pip freeze &gt; requirements.txt
</span></span></code></pre></div><p>Be sure to re-run that command and update in Git whenever you add new dependencies. When another programmer clones your project&rsquo;s repository, they can create a virtual environment and install all the required dependencies into it with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python3 -m pip install -r requirements.txt
</span></span></code></pre></div><p>Take a look at a few prominent OSS Python projects and notice that they all have a <code>requirements.txt</code> in the project root directory.</p><ul><li><a href=https://github.com/ansible/ansible>https://github.com/ansible/ansible</a></li><li><a href=https://github.com/numpy/numpy>https://github.com/numpy/numpy</a> &ndash; multiple task-specific requirements files</li><li><a href=https://github.com/pandas-dev/pandas>https://github.com/pandas-dev/pandas</a></li><li><a href=https://github.com/keras-team/keras>https://github.com/keras-team/keras</a></li><li><a href=https://github.com/pytorch/pytorch>https://github.com/pytorch/pytorch</a></li></ul><h2 id=conclusion>Conclusion</h2><ul><li>Use virtual environments to manage dependencies in Python projects.</li><li>Each project should have its own virtual environment, stored in a subdirectory of the project root directory.<ul><li>The overhead of a few megabytes to a few tens of megabytes is repaid many times over in reduced complexity.</li></ul></li><li>Don&rsquo;t forget to activate and deactivate environments.</li><li>Document your project&rsquo;s dependencies with a <code>requirements.txt</code> file.</li></ul></main><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js integrity=sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=../js/bootstrap.min.js></script></body></html>